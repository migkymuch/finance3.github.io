import{j as e,a as Ma,L as Aa,T as Ea,C as Ra,r as v,S as Nt,P as je,u as wt,c as Fs,b as Ta,d as ue,e as le,f as Oa,g as Pt,h as Ct,i as St,k as kt,l as Dt,m as Mt,n as Us,o as At,D as Et,p as Rt,O as Tt,q as _a,s as Fa,I as Ua,V as za,t as La,v as $a,w as Va,x as Ia,y as Ba,z as Ka,A as Ga,B as Ha,E as Ot,W as Wa,F as qa}from"./ui-9zpI-isT.js";import{a as Ja}from"./vendor-Dazix4UH.js";import{c as zs,R as os,L as _t,C as ys,X as bs,Y as Ns,T as ds,a as ws,P as Ya,b as Xa,d as Qa,B as Za,e as qs}from"./charts-C_TGw_V4.js";import{C as Je,D as Ps,T as Ne,a as Js,b as be,c as hs,d as er,e as sr,f as tr,g as Cs,X as Be,P as Me,h as ar,i as rr,S as oe,j as ie,k as Ft,l as nr,m as ir,n as Ae,Z as is,F as Ys,o as Xs,U as ls,H as Ls,W as lr,p as cr,A as or,q as dr,r as Ss,s as Qs,t as ss,u as Zs,v as hr,w as cs,G as mr,x as xr,R as ur,y as pr,z as et,L as gr,I as st,M as fr}from"./icons-CuikfUPJ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var ts={},tt;function jr(){if(tt)return ts;tt=1;var a=Ja();return ts.createRoot=a.createRoot,ts.hydrateRoot=a.hydrateRoot,ts}var vr=jr();const $s="-",yr=a=>{const s=Nr(a),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=a;return{getClassGroupId:l=>{const o=l.split($s);return o[0]===""&&o.length!==1&&o.shift(),Ut(o,s)||br(l)},getConflictingClassGroupIds:(l,o)=>{const d=t[l]||[];return o&&r[l]?[...d,...r[l]]:d}}},Ut=(a,s)=>{if(a.length===0)return s.classGroupId;const t=a[0],r=s.nextPart.get(t),n=r?Ut(a.slice(1),r):void 0;if(n)return n;if(s.validators.length===0)return;const i=a.join($s);return s.validators.find(({validator:l})=>l(i))?.classGroupId},at=/^\[(.+)\]$/,br=a=>{if(at.test(a)){const s=at.exec(a)[1],t=s?.substring(0,s.indexOf(":"));if(t)return"arbitrary.."+t}},Nr=a=>{const{theme:s,classGroups:t}=a,r={nextPart:new Map,validators:[]};for(const n in t)ks(t[n],r,n,s);return r},ks=(a,s,t,r)=>{a.forEach(n=>{if(typeof n=="string"){const i=n===""?s:rt(s,n);i.classGroupId=t;return}if(typeof n=="function"){if(wr(n)){ks(n(r),s,t,r);return}s.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([i,l])=>{ks(l,rt(s,i),t,r)})})},rt=(a,s)=>{let t=a;return s.split($s).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},wr=a=>a.isThemeGetter,Pr=a=>{if(a<1)return{get:()=>{},set:()=>{}};let s=0,t=new Map,r=new Map;const n=(i,l)=>{t.set(i,l),s++,s>a&&(s=0,r=t,t=new Map)};return{get(i){let l=t.get(i);if(l!==void 0)return l;if((l=r.get(i))!==void 0)return n(i,l),l},set(i,l){t.has(i)?t.set(i,l):n(i,l)}}},Ds="!",Ms=":",Cr=Ms.length,Sr=a=>{const{prefix:s,experimentalParseClassName:t}=a;let r=n=>{const i=[];let l=0,o=0,d=0,m;for(let w=0;w<n.length;w++){let k=n[w];if(l===0&&o===0){if(k===Ms){i.push(n.slice(d,w)),d=w+Cr;continue}if(k==="/"){m=w;continue}}k==="["?l++:k==="]"?l--:k==="("?o++:k===")"&&o--}const b=i.length===0?n:n.substring(d),p=kr(b),C=p!==b,f=m&&m>d?m-d:void 0;return{modifiers:i,hasImportantModifier:C,baseClassName:p,maybePostfixModifierPosition:f}};if(s){const n=s+Ms,i=r;r=l=>l.startsWith(n)?i(l.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const n=r;r=i=>t({className:i,parseClassName:n})}return r},kr=a=>a.endsWith(Ds)?a.substring(0,a.length-1):a.startsWith(Ds)?a.substring(1):a,Dr=a=>{const s=Object.fromEntries(a.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const n=[];let i=[];return r.forEach(l=>{l[0]==="["||s[l]?(n.push(...i.sort(),l),i=[]):i.push(l)}),n.push(...i.sort()),n}},Mr=a=>({cache:Pr(a.cacheSize),parseClassName:Sr(a),sortModifiers:Dr(a),...yr(a)}),Ar=/\s+/,Er=(a,s)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:n,sortModifiers:i}=s,l=[],o=a.trim().split(Ar);let d="";for(let m=o.length-1;m>=0;m-=1){const b=o[m],{isExternal:p,modifiers:C,hasImportantModifier:f,baseClassName:w,maybePostfixModifierPosition:k}=t(b);if(p){d=b+(d.length>0?" "+d:d);continue}let T=!!k,E=r(T?w.substring(0,k):w);if(!E){if(!T){d=b+(d.length>0?" "+d:d);continue}if(E=r(w),!E){d=b+(d.length>0?" "+d:d);continue}T=!1}const S=i(C).join(":"),j=f?S+Ds:S,u=j+E;if(l.includes(u))continue;l.push(u);const c=n(E,T);for(let h=0;h<c.length;++h){const D=c[h];l.push(j+D)}d=b+(d.length>0?" "+d:d)}return d};function Rr(){let a=0,s,t,r="";for(;a<arguments.length;)(s=arguments[a++])&&(t=zt(s))&&(r&&(r+=" "),r+=t);return r}const zt=a=>{if(typeof a=="string")return a;let s,t="";for(let r=0;r<a.length;r++)a[r]&&(s=zt(a[r]))&&(t&&(t+=" "),t+=s);return t};function Tr(a,...s){let t,r,n,i=l;function l(d){const m=s.reduce((b,p)=>p(b),a());return t=Mr(m),r=t.cache.get,n=t.cache.set,i=o,o(d)}function o(d){const m=r(d);if(m)return m;const b=Er(d,t);return n(d,b),b}return function(){return i(Rr.apply(null,arguments))}}const Q=a=>{const s=t=>t[a]||[];return s.isThemeGetter=!0,s},Lt=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,$t=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Or=/^\d+\/\d+$/,_r=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Fr=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ur=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,zr=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Lr=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Se=a=>Or.test(a),V=a=>!!a&&!Number.isNaN(Number(a)),xe=a=>!!a&&Number.isInteger(Number(a)),gs=a=>a.endsWith("%")&&V(a.slice(0,-1)),ce=a=>_r.test(a),$r=()=>!0,Vr=a=>Fr.test(a)&&!Ur.test(a),Vt=()=>!1,Ir=a=>zr.test(a),Br=a=>Lr.test(a),Kr=a=>!M(a)&&!A(a),Gr=a=>Ue(a,Kt,Vt),M=a=>Lt.test(a),ve=a=>Ue(a,Gt,Vr),fs=a=>Ue(a,Yr,V),nt=a=>Ue(a,It,Vt),Hr=a=>Ue(a,Bt,Br),as=a=>Ue(a,Ht,Ir),A=a=>$t.test(a),Ve=a=>ze(a,Gt),Wr=a=>ze(a,Xr),it=a=>ze(a,It),qr=a=>ze(a,Kt),Jr=a=>ze(a,Bt),rs=a=>ze(a,Ht,!0),Ue=(a,s,t)=>{const r=Lt.exec(a);return r?r[1]?s(r[1]):t(r[2]):!1},ze=(a,s,t=!1)=>{const r=$t.exec(a);return r?r[1]?s(r[1]):t:!1},It=a=>a==="position"||a==="percentage",Bt=a=>a==="image"||a==="url",Kt=a=>a==="length"||a==="size"||a==="bg-size",Gt=a=>a==="length",Yr=a=>a==="number",Xr=a=>a==="family-name",Ht=a=>a==="shadow",Qr=()=>{const a=Q("color"),s=Q("font"),t=Q("text"),r=Q("font-weight"),n=Q("tracking"),i=Q("leading"),l=Q("breakpoint"),o=Q("container"),d=Q("spacing"),m=Q("radius"),b=Q("shadow"),p=Q("inset-shadow"),C=Q("text-shadow"),f=Q("drop-shadow"),w=Q("blur"),k=Q("perspective"),T=Q("aspect"),E=Q("ease"),S=Q("animate"),j=()=>["auto","avoid","all","avoid-page","page","left","right","column"],u=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],c=()=>[...u(),A,M],h=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto","contain","none"],x=()=>[A,M,d],y=()=>[Se,"full","auto",...x()],W=()=>[xe,"none","subgrid",A,M],K=()=>["auto",{span:["full",xe,A,M]},xe,A,M],X=()=>[xe,"auto",A,M],me=()=>["auto","min","max","fr",A,M],Ce=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ne=()=>["start","end","center","stretch","center-safe","end-safe"],ee=()=>["auto",...x()],te=()=>[Se,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...x()],_=()=>[a,A,M],$e=()=>[...u(),it,nt,{position:[A,M]}],Ks=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Gs=()=>["auto","cover","contain",qr,Gr,{size:[A,M]}],us=()=>[gs,Ve,ve],se=()=>["","none","full",m,A,M],ae=()=>["",V,Ve,ve],Xe=()=>["solid","dashed","dotted","double"],Hs=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Z=()=>[V,gs,it,nt],Ws=()=>["","none",w,A,M],Qe=()=>["none",V,A,M],Ze=()=>["none",V,A,M],ps=()=>[V,A,M],es=()=>[Se,"full",...x()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ce],breakpoint:[ce],color:[$r],container:[ce],"drop-shadow":[ce],ease:["in","out","in-out"],font:[Kr],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ce],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ce],shadow:[ce],spacing:["px",V],text:[ce],"text-shadow":[ce],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Se,M,A,T]}],container:["container"],columns:[{columns:[V,M,A,o]}],"break-after":[{"break-after":j()}],"break-before":[{"break-before":j()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:c()}],overflow:[{overflow:h()}],"overflow-x":[{"overflow-x":h()}],"overflow-y":[{"overflow-y":h()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:y()}],"inset-x":[{"inset-x":y()}],"inset-y":[{"inset-y":y()}],start:[{start:y()}],end:[{end:y()}],top:[{top:y()}],right:[{right:y()}],bottom:[{bottom:y()}],left:[{left:y()}],visibility:["visible","invisible","collapse"],z:[{z:[xe,"auto",A,M]}],basis:[{basis:[Se,"full","auto",o,...x()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[V,Se,"auto","initial","none",M]}],grow:[{grow:["",V,A,M]}],shrink:[{shrink:["",V,A,M]}],order:[{order:[xe,"first","last","none",A,M]}],"grid-cols":[{"grid-cols":W()}],"col-start-end":[{col:K()}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":W()}],"row-start-end":[{row:K()}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":me()}],"auto-rows":[{"auto-rows":me()}],gap:[{gap:x()}],"gap-x":[{"gap-x":x()}],"gap-y":[{"gap-y":x()}],"justify-content":[{justify:[...Ce(),"normal"]}],"justify-items":[{"justify-items":[...ne(),"normal"]}],"justify-self":[{"justify-self":["auto",...ne()]}],"align-content":[{content:["normal",...Ce()]}],"align-items":[{items:[...ne(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ne(),{baseline:["","last"]}]}],"place-content":[{"place-content":Ce()}],"place-items":[{"place-items":[...ne(),"baseline"]}],"place-self":[{"place-self":["auto",...ne()]}],p:[{p:x()}],px:[{px:x()}],py:[{py:x()}],ps:[{ps:x()}],pe:[{pe:x()}],pt:[{pt:x()}],pr:[{pr:x()}],pb:[{pb:x()}],pl:[{pl:x()}],m:[{m:ee()}],mx:[{mx:ee()}],my:[{my:ee()}],ms:[{ms:ee()}],me:[{me:ee()}],mt:[{mt:ee()}],mr:[{mr:ee()}],mb:[{mb:ee()}],ml:[{ml:ee()}],"space-x":[{"space-x":x()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":x()}],"space-y-reverse":["space-y-reverse"],size:[{size:te()}],w:[{w:[o,"screen",...te()]}],"min-w":[{"min-w":[o,"screen","none",...te()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[l]},...te()]}],h:[{h:["screen","lh",...te()]}],"min-h":[{"min-h":["screen","lh","none",...te()]}],"max-h":[{"max-h":["screen","lh",...te()]}],"font-size":[{text:["base",t,Ve,ve]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,A,fs]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",gs,M]}],"font-family":[{font:[Wr,M,s]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,A,M]}],"line-clamp":[{"line-clamp":[V,"none",A,fs]}],leading:[{leading:[i,...x()]}],"list-image":[{"list-image":["none",A,M]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",A,M]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:_()}],"text-color":[{text:_()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Xe(),"wavy"]}],"text-decoration-thickness":[{decoration:[V,"from-font","auto",A,ve]}],"text-decoration-color":[{decoration:_()}],"underline-offset":[{"underline-offset":[V,"auto",A,M]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:x()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",A,M]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",A,M]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:$e()}],"bg-repeat":[{bg:Ks()}],"bg-size":[{bg:Gs()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xe,A,M],radial:["",A,M],conic:[xe,A,M]},Jr,Hr]}],"bg-color":[{bg:_()}],"gradient-from-pos":[{from:us()}],"gradient-via-pos":[{via:us()}],"gradient-to-pos":[{to:us()}],"gradient-from":[{from:_()}],"gradient-via":[{via:_()}],"gradient-to":[{to:_()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:ae()}],"border-w-x":[{"border-x":ae()}],"border-w-y":[{"border-y":ae()}],"border-w-s":[{"border-s":ae()}],"border-w-e":[{"border-e":ae()}],"border-w-t":[{"border-t":ae()}],"border-w-r":[{"border-r":ae()}],"border-w-b":[{"border-b":ae()}],"border-w-l":[{"border-l":ae()}],"divide-x":[{"divide-x":ae()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ae()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Xe(),"hidden","none"]}],"divide-style":[{divide:[...Xe(),"hidden","none"]}],"border-color":[{border:_()}],"border-color-x":[{"border-x":_()}],"border-color-y":[{"border-y":_()}],"border-color-s":[{"border-s":_()}],"border-color-e":[{"border-e":_()}],"border-color-t":[{"border-t":_()}],"border-color-r":[{"border-r":_()}],"border-color-b":[{"border-b":_()}],"border-color-l":[{"border-l":_()}],"divide-color":[{divide:_()}],"outline-style":[{outline:[...Xe(),"none","hidden"]}],"outline-offset":[{"outline-offset":[V,A,M]}],"outline-w":[{outline:["",V,Ve,ve]}],"outline-color":[{outline:_()}],shadow:[{shadow:["","none",b,rs,as]}],"shadow-color":[{shadow:_()}],"inset-shadow":[{"inset-shadow":["none",p,rs,as]}],"inset-shadow-color":[{"inset-shadow":_()}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:_()}],"ring-offset-w":[{"ring-offset":[V,ve]}],"ring-offset-color":[{"ring-offset":_()}],"inset-ring-w":[{"inset-ring":ae()}],"inset-ring-color":[{"inset-ring":_()}],"text-shadow":[{"text-shadow":["none",C,rs,as]}],"text-shadow-color":[{"text-shadow":_()}],opacity:[{opacity:[V,A,M]}],"mix-blend":[{"mix-blend":[...Hs(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Hs()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[V]}],"mask-image-linear-from-pos":[{"mask-linear-from":Z()}],"mask-image-linear-to-pos":[{"mask-linear-to":Z()}],"mask-image-linear-from-color":[{"mask-linear-from":_()}],"mask-image-linear-to-color":[{"mask-linear-to":_()}],"mask-image-t-from-pos":[{"mask-t-from":Z()}],"mask-image-t-to-pos":[{"mask-t-to":Z()}],"mask-image-t-from-color":[{"mask-t-from":_()}],"mask-image-t-to-color":[{"mask-t-to":_()}],"mask-image-r-from-pos":[{"mask-r-from":Z()}],"mask-image-r-to-pos":[{"mask-r-to":Z()}],"mask-image-r-from-color":[{"mask-r-from":_()}],"mask-image-r-to-color":[{"mask-r-to":_()}],"mask-image-b-from-pos":[{"mask-b-from":Z()}],"mask-image-b-to-pos":[{"mask-b-to":Z()}],"mask-image-b-from-color":[{"mask-b-from":_()}],"mask-image-b-to-color":[{"mask-b-to":_()}],"mask-image-l-from-pos":[{"mask-l-from":Z()}],"mask-image-l-to-pos":[{"mask-l-to":Z()}],"mask-image-l-from-color":[{"mask-l-from":_()}],"mask-image-l-to-color":[{"mask-l-to":_()}],"mask-image-x-from-pos":[{"mask-x-from":Z()}],"mask-image-x-to-pos":[{"mask-x-to":Z()}],"mask-image-x-from-color":[{"mask-x-from":_()}],"mask-image-x-to-color":[{"mask-x-to":_()}],"mask-image-y-from-pos":[{"mask-y-from":Z()}],"mask-image-y-to-pos":[{"mask-y-to":Z()}],"mask-image-y-from-color":[{"mask-y-from":_()}],"mask-image-y-to-color":[{"mask-y-to":_()}],"mask-image-radial":[{"mask-radial":[A,M]}],"mask-image-radial-from-pos":[{"mask-radial-from":Z()}],"mask-image-radial-to-pos":[{"mask-radial-to":Z()}],"mask-image-radial-from-color":[{"mask-radial-from":_()}],"mask-image-radial-to-color":[{"mask-radial-to":_()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":u()}],"mask-image-conic-pos":[{"mask-conic":[V]}],"mask-image-conic-from-pos":[{"mask-conic-from":Z()}],"mask-image-conic-to-pos":[{"mask-conic-to":Z()}],"mask-image-conic-from-color":[{"mask-conic-from":_()}],"mask-image-conic-to-color":[{"mask-conic-to":_()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:$e()}],"mask-repeat":[{mask:Ks()}],"mask-size":[{mask:Gs()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",A,M]}],filter:[{filter:["","none",A,M]}],blur:[{blur:Ws()}],brightness:[{brightness:[V,A,M]}],contrast:[{contrast:[V,A,M]}],"drop-shadow":[{"drop-shadow":["","none",f,rs,as]}],"drop-shadow-color":[{"drop-shadow":_()}],grayscale:[{grayscale:["",V,A,M]}],"hue-rotate":[{"hue-rotate":[V,A,M]}],invert:[{invert:["",V,A,M]}],saturate:[{saturate:[V,A,M]}],sepia:[{sepia:["",V,A,M]}],"backdrop-filter":[{"backdrop-filter":["","none",A,M]}],"backdrop-blur":[{"backdrop-blur":Ws()}],"backdrop-brightness":[{"backdrop-brightness":[V,A,M]}],"backdrop-contrast":[{"backdrop-contrast":[V,A,M]}],"backdrop-grayscale":[{"backdrop-grayscale":["",V,A,M]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[V,A,M]}],"backdrop-invert":[{"backdrop-invert":["",V,A,M]}],"backdrop-opacity":[{"backdrop-opacity":[V,A,M]}],"backdrop-saturate":[{"backdrop-saturate":[V,A,M]}],"backdrop-sepia":[{"backdrop-sepia":["",V,A,M]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":x()}],"border-spacing-x":[{"border-spacing-x":x()}],"border-spacing-y":[{"border-spacing-y":x()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",A,M]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[V,"initial",A,M]}],ease:[{ease:["linear","initial",E,A,M]}],delay:[{delay:[V,A,M]}],animate:[{animate:["none",S,A,M]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[k,A,M]}],"perspective-origin":[{"perspective-origin":c()}],rotate:[{rotate:Qe()}],"rotate-x":[{"rotate-x":Qe()}],"rotate-y":[{"rotate-y":Qe()}],"rotate-z":[{"rotate-z":Qe()}],scale:[{scale:Ze()}],"scale-x":[{"scale-x":Ze()}],"scale-y":[{"scale-y":Ze()}],"scale-z":[{"scale-z":Ze()}],"scale-3d":["scale-3d"],skew:[{skew:ps()}],"skew-x":[{"skew-x":ps()}],"skew-y":[{"skew-y":ps()}],transform:[{transform:[A,M,"","none","gpu","cpu"]}],"transform-origin":[{origin:c()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:es()}],"translate-x":[{"translate-x":es()}],"translate-y":[{"translate-y":es()}],"translate-z":[{"translate-z":es()}],"translate-none":["translate-none"],accent:[{accent:_()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:_()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",A,M]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":x()}],"scroll-mx":[{"scroll-mx":x()}],"scroll-my":[{"scroll-my":x()}],"scroll-ms":[{"scroll-ms":x()}],"scroll-me":[{"scroll-me":x()}],"scroll-mt":[{"scroll-mt":x()}],"scroll-mr":[{"scroll-mr":x()}],"scroll-mb":[{"scroll-mb":x()}],"scroll-ml":[{"scroll-ml":x()}],"scroll-p":[{"scroll-p":x()}],"scroll-px":[{"scroll-px":x()}],"scroll-py":[{"scroll-py":x()}],"scroll-ps":[{"scroll-ps":x()}],"scroll-pe":[{"scroll-pe":x()}],"scroll-pt":[{"scroll-pt":x()}],"scroll-pr":[{"scroll-pr":x()}],"scroll-pb":[{"scroll-pb":x()}],"scroll-pl":[{"scroll-pl":x()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",A,M]}],fill:[{fill:["none",..._()]}],"stroke-w":[{stroke:[V,Ve,ve,fs]}],stroke:[{stroke:["none",..._()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Wt=Tr(Qr);function U(...a){return Wt(zs(a))}function we({className:a,...s}){return e.jsx(Ma,{"data-slot":"tabs",className:U("flex flex-col gap-2",a),...s})}function Pe({className:a,...s}){return e.jsx(Aa,{"data-slot":"tabs-list",className:U("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",a),...s})}function G({className:a,...s}){return e.jsx(Ea,{"data-slot":"tabs-trigger",className:U("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...s})}function H({className:a,...s}){return e.jsx(Ra,{"data-slot":"tabs-content",className:U("flex-1 outline-none",a),...s})}const lt=a=>typeof a=="boolean"?`${a}`:a===0?"0":a,ct=zs,Vs=(a,s)=>t=>{var r;if(s?.variants==null)return ct(a,t?.class,t?.className);const{variants:n,defaultVariants:i}=s,l=Object.keys(n).map(m=>{const b=t?.[m],p=i?.[m];if(b===null)return null;const C=lt(b)||lt(p);return n[m][C]}),o=t&&Object.entries(t).reduce((m,b)=>{let[p,C]=b;return C===void 0||(m[p]=C),m},{}),d=s==null||(r=s.compoundVariants)===null||r===void 0?void 0:r.reduce((m,b)=>{let{class:p,className:C,...f}=b;return Object.entries(f).every(w=>{let[k,T]=w;return Array.isArray(T)?T.includes({...i,...o}[k]):{...i,...o}[k]===T})?[...m,p,C]:m},[]);return ct(a,l,d,t?.class,t?.className)},Is=Vs("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),O=v.forwardRef(({className:a,variant:s,size:t,asChild:r=!1,...n},i)=>{const l=r?Nt:"button";return e.jsx(l,{"data-slot":"button",className:U(Is({variant:s,size:t,className:a})),ref:i,...n})});O.displayName="Button";function P({className:a,...s}){return e.jsx("div",{"data-slot":"card",className:U("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",a),...s})}function z({className:a,...s}){return e.jsx("div",{"data-slot":"card-header",className:U("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...s})}function L({className:a,...s}){return e.jsx("h4",{"data-slot":"card-title",className:U("leading-none",a),...s})}function I({className:a,...s}){return e.jsx("p",{"data-slot":"card-description",className:U("text-muted-foreground",a),...s})}function $({className:a,...s}){return e.jsx("div",{"data-slot":"card-content",className:U("px-6 [&:last-child]:pb-6",a),...s})}const Zr=Vs("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function q({className:a,variant:s,asChild:t=!1,...r}){const n=t?Nt:"span";return e.jsx(n,{"data-slot":"badge",className:U(Zr({variant:s}),a),...r})}function As(...a){return Wt(zs(a))}function g(a,s="THB"){return s==="THB"?new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB",minimumFractionDigits:0,maximumFractionDigits:2}).format(a):new Intl.NumberFormat("en-US",{style:"currency",currency:s,minimumFractionDigits:0,maximumFractionDigits:2}).format(a)}function J(a,s=1){return new Intl.NumberFormat("th-TH",{style:"percent",minimumFractionDigits:s,maximumFractionDigits:s}).format(a/100)}function ot(a,s=0){return new Intl.NumberFormat("th-TH",{minimumFractionDigits:s,maximumFractionDigits:s}).format(a)}function Ke(a){const s=a.replace(/[,\s]/g,"").replace(/k$/i,"000").replace(/m$/i,"000000").replace(/[^\d.-]/g,""),t=parseFloat(s);return isNaN(t)?0:t}function en(a,s){const t=JSON.stringify(a,null,2),r=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}function dt(a,s){if(a.length===0)return;const t=Object.keys(a[0]),r=[t.join(","),...a.map(o=>t.map(d=>{const m=o[d];return typeof m=="string"&&(m.includes(",")||m.includes('"'))?`"${m.replace(/"/g,'""')}"`:m}).join(","))].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)}function ns({title:a,value:s,change:t,icon:r,status:n="good",description:i}){const l=()=>{switch(n){case"good":return"text-green-600";case"warning":return"text-yellow-600";case"danger":return"text-red-600";default:return"text-gray-600"}};return e.jsxs(P,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:a}),e.jsx("div",{className:l(),children:r})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s}),t!==void 0&&e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[t>0?e.jsx(Ne,{className:"w-3 h-3 mr-1"}):e.jsx(hs,{className:"w-3 h-3 mr-1"}),J(Math.abs(t))," จากเดือนที่แล้ว"]}),i&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i})]})]})}function sn({currentScenario:a,financialData:s}){if(!s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{children:"กำลังโหลดข้อมูลการเงิน..."})]})});const{kpis:t,pnl:r,menus:n}=s,i=[{month:"ม.ค.",revenue:18e4,costs:12e4,profit:6e4},{month:"ก.พ.",revenue:19e4,costs:125e3,profit:65e3},{month:"มี.ค.",revenue:2e5,costs:13e4,profit:7e4},{month:"เม.ย.",revenue:21e4,costs:135e3,profit:75e3},{month:"พ.ค.",revenue:195e3,costs:128e3,profit:67e3},{month:"มิ.ย.",revenue:205e3,costs:132e3,profit:73e3}],l=[{name:"วัตถุดิบ",value:t.foodCostPct,color:"#8884d8"},{name:"แรงงาน",value:t.laborPct,color:"#82ca9d"},{name:"ค่าใช้จ่ายคงที่",value:100-t.foodCostPct-t.laborPct,color:"#ffc658"}],o=(d,m)=>{switch(d){case"primeCost":return m>65?"danger":m>55?"warning":"good";case"foodCost":return m>35?"danger":m>30?"warning":"good";case"safetyMargin":return m<20?"danger":m<40?"warning":"good";default:return"good"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"แดชบอร์ดการเงิน"}),e.jsx("p",{className:"text-muted-foreground",children:"ภาพรวมผลการดำเนินงานและตัวชี้วัดสำคัญ"})]}),e.jsxs(q,{variant:"outline",className:"text-sm",children:["สถานการณ์: ",a==="base"?"ฐาน (Base)":a]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ns,{title:"รายได้รายวัน",value:g(t.revenue),icon:e.jsx(Ps,{className:"h-4 w-4"}),description:"จากยอดขายประมาณ"}),e.jsx(ns,{title:"กำไรขั้นต้น",value:g(t.grossProfit),icon:e.jsx(Ne,{className:"h-4 w-4"}),description:`อัตรากำไรขั้นต้น ${J(t.grossProfit/t.revenue*100)}`}),e.jsx(ns,{title:"Prime Cost %",value:J(t.primeCostPct),status:o("primeCost",t.primeCostPct),icon:e.jsx(Js,{className:"h-4 w-4"}),description:"วัตถุดิบ + แรงงานโดยตรง"}),e.jsx(ns,{title:"จุดคุ้มทุน/วัน",value:`${ot(t.bepPerDay)} จาน`,icon:e.jsx(Js,{className:"h-4 w-4"}),description:`Safety Margin: ${J(t.safetyMargin)}`,status:o("safetyMargin",t.safetyMargin)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Food Cost %"}),e.jsx("div",{className:"text-xl font-bold mt-1",children:J(t.foodCostPct)})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Labor %"}),e.jsx("div",{className:"text-xl font-bold mt-1",children:J(t.laborPct)})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Avg Ticket"}),e.jsx("div",{className:"text-xl font-bold mt-1",children:g(t.avgTicket)})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"CM %"}),e.jsx("div",{className:"text-xl font-bold mt-1",children:J(t.cmPct)})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Operating Profit"}),e.jsx("div",{className:"text-xl font-bold mt-1",children:g(t.operatingProfit)})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"BEP Units/Month"}),e.jsx("div",{className:"text-xl font-bold mt-1",children:ot(t.bepUnits)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"แนวโน้มรายได้และกำไร"}),e.jsx(I,{children:"6 เดือนที่ผ่านมา"})]}),e.jsx($,{children:e.jsx(os,{width:"100%",height:300,children:e.jsxs(_t,{data:i,children:[e.jsx(ys,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"month"}),e.jsx(Ns,{tickFormatter:d=>g(d)}),e.jsx(ds,{formatter:d=>g(d)}),e.jsx(ws,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",strokeWidth:2,name:"รายได้"}),e.jsx(ws,{type:"monotone",dataKey:"profit",stroke:"#82ca9d",strokeWidth:2,name:"กำไร"})]})})})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"โครงสร้างต้นทุน"}),e.jsx(I,{children:"สัดส่วนต้นทุนต่อรายได้"})]}),e.jsx($,{children:e.jsx(os,{width:"100%",height:300,children:e.jsxs(Ya,{children:[e.jsx(Xa,{data:l,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:d,value:m})=>`${d}: ${J(m)}`,children:l.map((d,m)=>e.jsx(Qa,{fill:d.color},`cell-${m}`))}),e.jsx(ds,{formatter:d=>J(d)})]})})})]})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"ผลการดำเนินงานรายเมนู"}),e.jsx(I,{children:"Unit Economics ของแต่ละรายการอาหาร"})]}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"เมนู"}),e.jsx("th",{className:"text-right py-2",children:"ราคาขาย"}),e.jsx("th",{className:"text-right py-2",children:"ต้นทุนผันแปร"}),e.jsx("th",{className:"text-right py-2",children:"Contribution Margin"}),e.jsx("th",{className:"text-right py-2",children:"CM %"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 font-medium",children:d.name}),e.jsx("td",{className:"text-right py-2",children:g(d.price)}),e.jsx("td",{className:"text-right py-2",children:g(d.vc)}),e.jsx("td",{className:"text-right py-2",children:g(d.cm)}),e.jsx("td",{className:"text-right py-2",children:e.jsx(q,{variant:d.cmPct>60?"default":d.cmPct>40?"secondary":"destructive",children:J(d.cmPct)})})]},d.id))})]})})})]}),e.jsxs(P,{children:[e.jsx(z,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5 text-yellow-500"}),"ข้อเสนอแนะการปรับปรุง"]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-3",children:[t.primeCostPct>60&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg",children:[e.jsx(be,{className:"w-4 h-4 text-red-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-900",children:"Prime Cost สูงเกินมาตรฐาน"}),e.jsx("p",{className:"text-sm text-red-700",children:"ควรลดต้นทุนวัตถุดิบหรือปรับปรุงประสิทธิภาพแรงงาน"})]})]}),t.safetyMargin<30&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[e.jsx(be,{className:"w-4 h-4 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Safety Margin ต่ำ"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"ควรเพิ่มยอดขายหรือลดต้นทุนคงที่เพื่อความปลอดภัยทางการเงิน"})]})]}),n.some(d=>d.cmPct<40)&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(Ne,{className:"w-4 h-4 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"เมนูที่ควรปรับปรุง CM"}),e.jsx("p",{className:"text-sm text-blue-700",children:"บางเมนูมี Contribution Margin ต่ำ ควรทบทวนราคาขายหรือต้นทุน"})]})]})]})})]})]})}function B({className:a,type:s,...t}){return e.jsx("input",{type:s,"data-slot":"input",className:U("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...t})}var tn="Label",qt=v.forwardRef((a,s)=>e.jsx(je.label,{...a,ref:s,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(a.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));qt.displayName=tn;var an=qt;function R({className:a,...s}){return e.jsx(an,{"data-slot":"label",className:U("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...s})}var Jt=["PageUp","PageDown"],Yt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Xt={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Le="Slider",[Es,rn,nn]=Ta(Le),[Qt]=Fs(Le,[nn]),[ln,ms]=Qt(Le),Zt=v.forwardRef((a,s)=>{const{name:t,min:r=0,max:n=100,step:i=1,orientation:l="horizontal",disabled:o=!1,minStepsBetweenThumbs:d=0,defaultValue:m=[r],value:b,onValueChange:p=()=>{},onValueCommit:C=()=>{},inverted:f=!1,form:w,...k}=a,T=v.useRef(new Set),E=v.useRef(0),j=l==="horizontal"?cn:on,[u=[],c]=wt({prop:b,defaultProp:m,onChange:K=>{[...T.current][E.current]?.focus(),p(K)}}),h=v.useRef(u);function D(K){const X=un(u,K);W(K,X)}function x(K){W(K,E.current)}function y(){const K=h.current[E.current];u[E.current]!==K&&C(u)}function W(K,X,{commit:me}={commit:!1}){const Ce=jn(i),ne=vn(Math.round((K-r)/i)*i+r,Ce),ee=Pt(ne,[r,n]);c((te=[])=>{const _=mn(te,ee,X);if(fn(_,d*i)){E.current=_.indexOf(ee);const $e=String(_)!==String(te);return $e&&me&&C(_),$e?_:te}else return te})}return e.jsx(ln,{scope:a.__scopeSlider,name:t,disabled:o,min:r,max:n,valueIndexToChangeRef:E,thumbs:T.current,values:u,orientation:l,form:w,children:e.jsx(Es.Provider,{scope:a.__scopeSlider,children:e.jsx(Es.Slot,{scope:a.__scopeSlider,children:e.jsx(j,{"aria-disabled":o,"data-disabled":o?"":void 0,...k,ref:s,onPointerDown:ue(k.onPointerDown,()=>{o||(h.current=u)}),min:r,max:n,inverted:f,onSlideStart:o?void 0:D,onSlideMove:o?void 0:x,onSlideEnd:o?void 0:y,onHomeKeyDown:()=>!o&&W(r,0,{commit:!0}),onEndKeyDown:()=>!o&&W(n,u.length-1,{commit:!0}),onStepKeyDown:({event:K,direction:X})=>{if(!o){const ne=Jt.includes(K.key)||K.shiftKey&&Yt.includes(K.key)?10:1,ee=E.current,te=u[ee],_=i*ne*X;W(te+_,ee,{commit:!0})}}})})})})});Zt.displayName=Le;var[ea,sa]=Qt(Le,{startEdge:"left",endEdge:"right",size:"width",direction:1}),cn=v.forwardRef((a,s)=>{const{min:t,max:r,dir:n,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:d,onStepKeyDown:m,...b}=a,[p,C]=v.useState(null),f=le(s,j=>C(j)),w=v.useRef(void 0),k=Oa(n),T=k==="ltr",E=T&&!i||!T&&i;function S(j){const u=w.current||p.getBoundingClientRect(),c=[0,u.width],D=Bs(c,E?[t,r]:[r,t]);return w.current=u,D(j-u.left)}return e.jsx(ea,{scope:a.__scopeSlider,startEdge:E?"left":"right",endEdge:E?"right":"left",direction:E?1:-1,size:"width",children:e.jsx(ta,{dir:k,"data-orientation":"horizontal",...b,ref:f,style:{...b.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:j=>{const u=S(j.clientX);l?.(u)},onSlideMove:j=>{const u=S(j.clientX);o?.(u)},onSlideEnd:()=>{w.current=void 0,d?.()},onStepKeyDown:j=>{const c=Xt[E?"from-left":"from-right"].includes(j.key);m?.({event:j,direction:c?-1:1})}})})}),on=v.forwardRef((a,s)=>{const{min:t,max:r,inverted:n,onSlideStart:i,onSlideMove:l,onSlideEnd:o,onStepKeyDown:d,...m}=a,b=v.useRef(null),p=le(s,b),C=v.useRef(void 0),f=!n;function w(k){const T=C.current||b.current.getBoundingClientRect(),E=[0,T.height],j=Bs(E,f?[r,t]:[t,r]);return C.current=T,j(k-T.top)}return e.jsx(ea,{scope:a.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:e.jsx(ta,{"data-orientation":"vertical",...m,ref:p,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:k=>{const T=w(k.clientY);i?.(T)},onSlideMove:k=>{const T=w(k.clientY);l?.(T)},onSlideEnd:()=>{C.current=void 0,o?.()},onStepKeyDown:k=>{const E=Xt[f?"from-bottom":"from-top"].includes(k.key);d?.({event:k,direction:E?-1:1})}})})}),ta=v.forwardRef((a,s)=>{const{__scopeSlider:t,onSlideStart:r,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:d,...m}=a,b=ms(Le,t);return e.jsx(je.span,{...m,ref:s,onKeyDown:ue(a.onKeyDown,p=>{p.key==="Home"?(l(p),p.preventDefault()):p.key==="End"?(o(p),p.preventDefault()):Jt.concat(Yt).includes(p.key)&&(d(p),p.preventDefault())}),onPointerDown:ue(a.onPointerDown,p=>{const C=p.target;C.setPointerCapture(p.pointerId),p.preventDefault(),b.thumbs.has(C)?C.focus():r(p)}),onPointerMove:ue(a.onPointerMove,p=>{p.target.hasPointerCapture(p.pointerId)&&n(p)}),onPointerUp:ue(a.onPointerUp,p=>{const C=p.target;C.hasPointerCapture(p.pointerId)&&(C.releasePointerCapture(p.pointerId),i(p))})})}),aa="SliderTrack",ra=v.forwardRef((a,s)=>{const{__scopeSlider:t,...r}=a,n=ms(aa,t);return e.jsx(je.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:s})});ra.displayName=aa;var Rs="SliderRange",na=v.forwardRef((a,s)=>{const{__scopeSlider:t,...r}=a,n=ms(Rs,t),i=sa(Rs,t),l=v.useRef(null),o=le(s,l),d=n.values.length,m=n.values.map(C=>ca(C,n.min,n.max)),b=d>1?Math.min(...m):0,p=100-Math.max(...m);return e.jsx(je.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...r,ref:o,style:{...a.style,[i.startEdge]:b+"%",[i.endEdge]:p+"%"}})});na.displayName=Rs;var Ts="SliderThumb",ia=v.forwardRef((a,s)=>{const t=rn(a.__scopeSlider),[r,n]=v.useState(null),i=le(s,o=>n(o)),l=v.useMemo(()=>r?t().findIndex(o=>o.ref.current===r):-1,[t,r]);return e.jsx(dn,{...a,ref:i,index:l})}),dn=v.forwardRef((a,s)=>{const{__scopeSlider:t,index:r,name:n,...i}=a,l=ms(Ts,t),o=sa(Ts,t),[d,m]=v.useState(null),b=le(s,S=>m(S)),p=d?l.form||!!d.closest("form"):!0,C=Ct(d),f=l.values[r],w=f===void 0?0:ca(f,l.min,l.max),k=xn(r,l.values.length),T=C?.[o.size],E=T?pn(T,w,o.direction):0;return v.useEffect(()=>{if(d)return l.thumbs.add(d),()=>{l.thumbs.delete(d)}},[d,l.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${w}% + ${E}px)`},children:[e.jsx(Es.ItemSlot,{scope:a.__scopeSlider,children:e.jsx(je.span,{role:"slider","aria-label":a["aria-label"]||k,"aria-valuemin":l.min,"aria-valuenow":f,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...i,ref:b,style:f===void 0?{display:"none"}:a.style,onFocus:ue(a.onFocus,()=>{l.valueIndexToChangeRef.current=r})})}),p&&e.jsx(la,{name:n??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:f},r)]})});ia.displayName=Ts;var hn="RadioBubbleInput",la=v.forwardRef(({__scopeSlider:a,value:s,...t},r)=>{const n=v.useRef(null),i=le(n,r),l=St(s);return v.useEffect(()=>{const o=n.current;if(!o)return;const d=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(d,"value").set;if(l!==s&&b){const p=new Event("input",{bubbles:!0});b.call(o,s),o.dispatchEvent(p)}},[l,s]),e.jsx(je.input,{style:{display:"none"},...t,ref:i,defaultValue:s})});la.displayName=hn;function mn(a=[],s,t){const r=[...a];return r[t]=s,r.sort((n,i)=>n-i)}function ca(a,s,t){const i=100/(t-s)*(a-s);return Pt(i,[0,100])}function xn(a,s){return s>2?`Value ${a+1} of ${s}`:s===2?["Minimum","Maximum"][a]:void 0}function un(a,s){if(a.length===1)return 0;const t=a.map(n=>Math.abs(n-s)),r=Math.min(...t);return t.indexOf(r)}function pn(a,s,t){const r=a/2,i=Bs([0,50],[0,r]);return(r-i(s)*t)*t}function gn(a){return a.slice(0,-1).map((s,t)=>a[t+1]-s)}function fn(a,s){if(s>0){const t=gn(a);return Math.min(...t)>=s}return!0}function Bs(a,s){return t=>{if(a[0]===a[1]||s[0]===s[1])return s[0];const r=(s[1]-s[0])/(a[1]-a[0]);return s[0]+r*(t-a[0])}}function jn(a){return(String(a).split(".")[1]||"").length}function vn(a,s){const t=Math.pow(10,s);return Math.round(a*t)/t}var yn=Zt,bn=ra,Nn=na,wn=ia;function ye({className:a,defaultValue:s,value:t,min:r=0,max:n=100,...i}){const l=v.useMemo(()=>Array.isArray(t)?t:Array.isArray(s)?s:[r,n],[t,s,r,n]);return e.jsxs(yn,{"data-slot":"slider",defaultValue:s,value:t,min:r,max:n,className:U("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...i,children:[e.jsx(bn,{"data-slot":"slider-track",className:U("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(Nn,{"data-slot":"slider-range",className:U("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:l.length},(o,d)=>e.jsx(wn,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},d))]})}class ht{data={};scenarios={};constructor(){this.initializeDefaultData()}init(){this.loadFromStorage()}initializeDefaultData(){this.data={meta:{currency:"THB",vatPercent:7,openDays:["Mon","Tue","Wed","Thu","Fri","Sat"],operatingHours:{open:"07:00",close:"15:00"}},menus:[{id:"khao_man_gai",name:"ข้าวมันไก่",price:60,channelMix:{dineIn:.7,takeaway:.2,delivery:.1},bom:[{item:"chicken_thigh",qtyG:120,unitCostPerKg:70,yieldPercent:85,wastePercent:5},{item:"rice",qtyG:180,unitCostPerKg:30,yieldPercent:95,wastePercent:2},{item:"sauce",qtyG:30,unitCostPerKg:60,yieldPercent:100,wastePercent:0},{item:"packaging",qtyG:0,unitCostPerKg:0,yieldPercent:100,wastePercent:0,packaging:{qtyUnit:1,unitCost:2.5}}]}],salesModel:{forecastDailyUnits:120,seasonality:{Jan:.9,Feb:.95,Mar:1,Apr:1.1,May:1,Jun:.9,Jul:.9,Aug:1.1,Sep:1,Oct:1,Nov:1.1,Dec:1.2},paymentFeePercent:1.5,deliveryCommissionPercent:25},utilities:[{id:"ac_main",type:"electric",device:"เครื่องปรับอากาศ",kw:2.5,hoursPerDay:6,ratePerKwh:5},{id:"rice_cooker",type:"electric",device:"หม้อหุงข้าว",kw:1.8,hoursPerDay:3,ratePerKwh:5},{id:"gas_stove",type:"lpg",device:"เตาแก๊ส",kgPerBatch:.25,batchesPerDay:2,ratePerKg:29.33}],labor:[{id:"kitchen_chef",role:"พ่อครัว",type:"direct",wagePerHour:45,hoursPerDay:8,daysPerWeek:6},{id:"cashier",role:"แคชเชียร์",type:"indirect",wagePerHour:40,hoursPerDay:6,daysPerWeek:6}],fixedCosts:[{id:"rent",name:"ค่าเช่า",amountPerMonth:0},{id:"internet",name:"อินเทอร์เน็ต",amountPerMonth:700},{id:"maintenance",name:"ซ่อมบำรุง",amountPerMonth:1e3},{id:"depreciation",name:"ค่าเสื่อมราคา",amountPerMonth:1500}]},this.scenarios={base:{id:"base",name:"ฐาน (Base)",deltas:{}},S1:{id:"S1",name:"สถานการณ์ 1",deltas:{menuPriceDeltaPercent:5,ingredientCostDeltaPercent:8}}}}compute(){try{if(!this.validateData())return console.error("Data validation failed"),this.getDefaultComputationResult();const s=this.calculatePnL(),t=this.calculateKPIs(s),r=this.calculateMenuMetrics();return{pnl:s,kpis:t,menus:r,sensitivity:this.calculateSensitivity(),computedAt:new Date().toISOString(),dataVersion:this.getDataVersion()}}catch(s){return console.error("Error in computation:",s),this.getDefaultComputationResult()}}validateData(){try{return this.data?!this.data.menus||!Array.isArray(this.data.menus)||this.data.menus.length===0?(console.warn("No menus data available"),!1):!this.data.salesModel||typeof this.data.salesModel.forecastDailyUnits!="number"?(console.warn("Invalid sales model data"),!1):!Array.isArray(this.data.utilities)||!Array.isArray(this.data.labor)||!Array.isArray(this.data.fixedCosts)?(console.warn("Invalid utilities, labor, or fixed costs data"),!1):!0:(console.warn("No data available"),!1)}catch(s){return console.error("Error validating data:",s),!1}}getDefaultComputationResult(){return{pnl:{daily:{revenue:0,cogs:0,grossProfit:0,operatingExpenses:0,operatingProfit:0},monthly:{revenue:0,cogs:0,grossProfit:0,operatingExpenses:0,operatingProfit:0}},kpis:this.getDefaultFinancialMetrics(),menus:[],sensitivity:{variable:"ingredient_cost",series:[]},computedAt:new Date().toISOString(),dataVersion:this.getDataVersion(),error:"Computation failed due to invalid data"}}getDataVersion(){try{const s=JSON.stringify(this.data);return btoa(s).substring(0,8)}catch{return"unknown"}}calculatePnL(){const s=this.calculateDailyRevenue(),t=this.calculateDailyCOGS(),r=this.calculateMonthlyFixedCosts(),n=this.calculateMonthlyLaborCosts(),i=this.calculateMonthlyUtilityCosts(),l=s-t,o=(r+n+i)/30,d=l-o;return{daily:{revenue:s,cogs:t,grossProfit:l,operatingExpenses:o,operatingProfit:d},monthly:{revenue:s*30,cogs:t*30,grossProfit:l*30,operatingExpenses:r+n+i,operatingProfit:d*30}}}calculateDailyRevenue(){return!this.data.salesModel||typeof this.data.salesModel.forecastDailyUnits!="number"?(console.warn("Invalid sales model data:",this.data.salesModel),0):!this.data.menus||!Array.isArray(this.data.menus)?(console.warn("Invalid menus data:",this.data.menus),0):this.data.menus.reduce((s,t)=>{if(!t||typeof t.price!="number"||!t.channelMix)return console.warn("Invalid menu data:",t),s;const{dineIn:r,takeaway:n,delivery:i}=t.channelMix;if(typeof r!="number"||typeof n!="number"||typeof i!="number")return console.warn("Invalid channel mix data:",t.channelMix),s;const l=Math.max(0,r),o=Math.max(0,n),d=Math.max(0,i),m=this.data.salesModel.forecastDailyUnits*(l+o+d);return s+t.price*m},0)}calculateDailyCOGS(){return this.data.menus.reduce((s,t)=>{const r=this.data.salesModel.forecastDailyUnits,n=this.calculateVariableCostPerUnit(t);return s+n*r},0)}calculateVariableCostPerUnit(s){return!s||!s.bom||!Array.isArray(s.bom)?(console.warn("Invalid menu or BOM data:",s),0):s.bom.reduce((t,r)=>{if(!r)return console.warn("Invalid BOM item:",r),t;if(r.packaging)return typeof r.packaging.qtyUnit!="number"||typeof r.packaging.unitCost!="number"?(console.warn("Invalid packaging data:",r.packaging),t):t+r.packaging.qtyUnit*r.packaging.unitCost;if(typeof r.qtyG!="number"||typeof r.unitCostPerKg!="number"||typeof r.yieldPercent!="number"||typeof r.wastePercent!="number")return console.warn("Invalid ingredient data:",r),t;if(r.yieldPercent<=0)return console.warn("Invalid yield percentage (must be > 0):",r.yieldPercent),t;const n=Math.max(0,r.wastePercent),i=r.yieldPercent/100,l=1+n/100,d=r.qtyG/1e3*l/i;return t+d*r.unitCostPerKg},0)}calculateMonthlyFixedCosts(){return this.data.fixedCosts.reduce((s,t)=>s+t.amountPerMonth,0)}calculateMonthlyLaborCosts(){return this.data.labor.reduce((s,t)=>{const r=t.hoursPerDay*t.daysPerWeek*4.33;return s+t.wagePerHour*r},0)}calculateMonthlyUtilityCosts(){return this.data.utilities.reduce((s,t)=>{let r=0;return t.type==="electric"&&t.kw&&t.hoursPerDay&&t.ratePerKwh?r=t.kw*t.hoursPerDay*t.ratePerKwh:t.type==="lpg"&&t.kgPerBatch&&t.batchesPerDay&&t.ratePerKg?r=t.kgPerBatch*t.batchesPerDay*t.ratePerKg:t.type==="water"&&t.m3PerDay&&t.ratePerM3&&(r=t.m3PerDay*t.ratePerM3),s+r*30},0)}calculateKPIs(s){if(!s||!s.daily)return console.warn("Invalid PnL data:",s),this.getDefaultFinancialMetrics();const t=s.daily.revenue||0,r=s.daily.grossProfit||0,n=s.daily.operatingProfit||0;if(!this.data.menus||!Array.isArray(this.data.menus)||this.data.menus.length===0)return console.warn("No menus data available for KPI calculation"),this.getDefaultFinancialMetrics();const l=this.data.menus.reduce((c,h)=>{if(!h||typeof h.price!="number")return console.warn("Invalid menu data for CM calculation:",h),c;const D=this.calculateVariableCostPerUnit(h),x=h.price-D;return c+x},0)/this.data.menus.length,o=this.calculateMonthlyFixedCosts()+this.calculateMonthlyLaborCosts()+this.calculateMonthlyUtilityCosts(),d=l>0?o/l:0,m=d/30,b=this.data.labor.filter(c=>c&&c.type==="direct").reduce((c,h)=>!h||typeof h.wagePerHour!="number"||typeof h.hoursPerDay!="number"?(console.warn("Invalid labor data:",h),c):c+h.wagePerHour*h.hoursPerDay,0),p=s.daily.cogs||0,C=p+b,f=t>0?C/t*100:0,w=t>0?p/t*100:0,k=t>0?b/t*100:0,T=this.data.menus.reduce((c,h)=>c+(h?.price||0),0)/this.data.menus.length,E=T>0?l/T*100:0,S=this.data.salesModel?.forecastDailyUnits||0,j=S>0?(S-m)/S*100:0,u=S>0?t/S:0;return{revenue:t,grossProfit:r,operatingProfit:n,netProfit:n,primeCostPct:f,foodCostPct:w,laborPct:k,cmPct:E,bepUnits:d,bepPerDay:m,safetyMargin:j,avgTicket:u}}getDefaultFinancialMetrics(){return{revenue:0,grossProfit:0,operatingProfit:0,netProfit:0,primeCostPct:0,foodCostPct:0,laborPct:0,cmPct:0,bepUnits:0,bepPerDay:0,safetyMargin:0,avgTicket:0}}calculateMenuMetrics(){return this.data.menus.map(s=>{const t=this.calculateVariableCostPerUnit(s),r=s.price-t,n=r/s.price*100;return{id:s.id,name:s.name,price:s.price,vc:t,cm:r,cmPct:n}})}calculateSensitivity(){return{variable:"ingredient_cost",series:[{change:-10,impact:15},{change:-5,impact:7.5},{change:0,impact:0},{change:5,impact:-7.5},{change:10,impact:-15}]}}save(){localStorage.setItem("finance_data",JSON.stringify(this.data)),localStorage.setItem("finance_scenarios",JSON.stringify(this.scenarios))}load(s){this.data=s}loadFromStorage(){const s=localStorage.getItem("finance_data"),t=localStorage.getItem("finance_scenarios");if(s)try{this.data=JSON.parse(s)}catch(r){console.error("Failed to load stored data:",r)}if(t)try{this.scenarios=JSON.parse(t)}catch(r){console.error("Failed to load stored scenarios:",r)}}exportJSON(){return JSON.stringify({data:this.data,scenarios:this.scenarios,exportDate:new Date().toISOString()},null,2)}importJSON(s){try{if(!s||typeof s!="string")return{success:!1,error:"Invalid JSON string provided"};const t=JSON.parse(s);if(!t.data||!t.scenarios)return{success:!1,error:"Invalid data structure: missing data or scenarios"};if(!Array.isArray(t.data.menus)||!Array.isArray(t.data.utilities)||!Array.isArray(t.data.labor)||!Array.isArray(t.data.fixedCosts))return{success:!1,error:"Invalid data structure: arrays expected for menus, utilities, labor, and fixedCosts"};const r={data:JSON.parse(JSON.stringify(this.data)),scenarios:JSON.parse(JSON.stringify(this.scenarios))};try{return this.data=t.data,this.scenarios=t.scenarios,this.validateData()?(this.save(),{success:!0}):(this.data=r.data,this.scenarios=r.scenarios,{success:!1,error:"Imported data failed validation"})}catch(n){return this.data=r.data,this.scenarios=r.scenarios,{success:!1,error:`Data validation failed: ${n}`}}}catch(t){return console.error("Failed to import JSON:",t),{success:!1,error:`JSON parsing failed: ${t.message}`}}}getData(){return this.data}getScenarios(){return this.scenarios}updateMenu(s,t){const r=this.data.menus.findIndex(n=>n.id===s);r>=0&&(this.data.menus[r]={...this.data.menus[r],...t},this.save())}updateSalesModel(s){this.data.salesModel={...this.data.salesModel,...s},this.save()}updateUtilities(s){this.data.utilities=s,this.save()}updateLabor(s){this.data.labor=s,this.save()}updateFixedCosts(s){this.data.fixedCosts=s,this.save()}}class ke{static MIN_PRICE=.01;static MAX_PRICE=1e4;static MIN_QUANTITY=0;static MAX_QUANTITY=1e4;static MIN_PERCENTAGE=0;static MAX_PERCENTAGE=1e3;static MIN_HOURS=0;static MAX_HOURS=24;static MIN_DAYS=0;static MAX_DAYS=7;static validateMenuItem(s){const t=[],r=[];if((!s.id||typeof s.id!="string")&&t.push("Menu ID is required and must be a string"),(!s.name||typeof s.name!="string")&&t.push("Menu name is required and must be a string"),typeof s.price!="number"||isNaN(s.price)?t.push("Price must be a valid number"):(s.price<this.MIN_PRICE&&t.push(`Price must be at least ${this.MIN_PRICE}`),s.price>this.MAX_PRICE&&r.push(`Price seems high: ${s.price}. Please verify.`)),!s.channelMix)t.push("Channel mix is required");else{const{dineIn:n,takeaway:i,delivery:l}=s.channelMix,o=(n||0)+(i||0)+(l||0);o<=0&&t.push("Channel mix total must be greater than 0"),o>1.5&&r.push(`Channel mix total (${o}) seems high. Please verify.`)}return Array.isArray(s.bom)?s.bom.forEach((n,i)=>{const l=this.validateBOMItem(n);l.errors.forEach(o=>t.push(`BOM item ${i+1}: ${o}`)),l.warnings.forEach(o=>r.push(`BOM item ${i+1}: ${o}`))}):t.push("BOM must be an array"),{isValid:t.length===0,errors:t,warnings:r}}static validateBOMItem(s){const t=[],r=[];return(!s.item||typeof s.item!="string")&&t.push("Item name is required"),typeof s.qtyG!="number"||isNaN(s.qtyG)?t.push("Quantity (grams) must be a valid number"):(s.qtyG<this.MIN_QUANTITY&&t.push(`Quantity must be at least ${this.MIN_QUANTITY}`),s.qtyG>this.MAX_QUANTITY&&r.push(`Quantity seems high: ${s.qtyG}g. Please verify.`)),typeof s.unitCostPerKg!="number"||isNaN(s.unitCostPerKg)?t.push("Unit cost per kg must be a valid number"):(s.unitCostPerKg<0&&t.push("Unit cost cannot be negative"),s.unitCostPerKg>1e3&&r.push(`Unit cost seems high: ${s.unitCostPerKg} THB/kg. Please verify.`)),typeof s.yieldPercent!="number"||isNaN(s.yieldPercent)?t.push("Yield percentage must be a valid number"):(s.yieldPercent<=0&&t.push("Yield percentage must be greater than 0"),s.yieldPercent>100&&r.push(`Yield percentage (${s.yieldPercent}%) seems high. Please verify.`)),typeof s.wastePercent!="number"||isNaN(s.wastePercent)?t.push("Waste percentage must be a valid number"):(s.wastePercent<0&&t.push("Waste percentage cannot be negative"),s.wastePercent>50&&r.push(`Waste percentage (${s.wastePercent}%) seems high. Please verify.`)),s.packaging&&((typeof s.packaging.qtyUnit!="number"||isNaN(s.packaging.qtyUnit))&&t.push("Packaging quantity must be a valid number"),typeof s.packaging.unitCost!="number"||isNaN(s.packaging.unitCost)?t.push("Packaging unit cost must be a valid number"):s.packaging.unitCost<0&&t.push("Packaging unit cost cannot be negative")),{isValid:t.length===0,errors:t,warnings:r}}static validateSalesModel(s){const t=[],r=[];return typeof s.forecastDailyUnits!="number"||isNaN(s.forecastDailyUnits)?t.push("Daily units forecast must be a valid number"):(s.forecastDailyUnits<1&&t.push("Daily units forecast must be at least 1"),s.forecastDailyUnits>1e3&&r.push(`Daily units forecast (${s.forecastDailyUnits}) seems high. Please verify.`)),typeof s.paymentFeePercent!="number"||isNaN(s.paymentFeePercent)?t.push("Payment fee percentage must be a valid number"):(s.paymentFeePercent<0&&t.push("Payment fee percentage cannot be negative"),s.paymentFeePercent>10&&r.push(`Payment fee (${s.paymentFeePercent}%) seems high. Please verify.`)),typeof s.deliveryCommissionPercent!="number"||isNaN(s.deliveryCommissionPercent)?t.push("Delivery commission percentage must be a valid number"):(s.deliveryCommissionPercent<0&&t.push("Delivery commission percentage cannot be negative"),s.deliveryCommissionPercent>50&&r.push(`Delivery commission (${s.deliveryCommissionPercent}%) seems high. Please verify.`)),{isValid:t.length===0,errors:t,warnings:r}}static validateLaborItem(s){const t=[],r=[];return(!s.id||typeof s.id!="string")&&t.push("Labor ID is required"),(!s.role||typeof s.role!="string")&&t.push("Role is required"),(!s.type||!["direct","indirect"].includes(s.type))&&t.push('Type must be either "direct" or "indirect"'),typeof s.wagePerHour!="number"||isNaN(s.wagePerHour)?t.push("Wage per hour must be a valid number"):(s.wagePerHour<0&&t.push("Wage cannot be negative"),s.wagePerHour>1e3&&r.push(`Wage (${s.wagePerHour} THB/hour) seems high. Please verify.`)),typeof s.hoursPerDay!="number"||isNaN(s.hoursPerDay)?t.push("Hours per day must be a valid number"):(s.hoursPerDay<this.MIN_HOURS&&t.push(`Hours per day must be at least ${this.MIN_HOURS}`),s.hoursPerDay>this.MAX_HOURS&&t.push(`Hours per day cannot exceed ${this.MAX_HOURS}`)),typeof s.daysPerWeek!="number"||isNaN(s.daysPerWeek)?t.push("Days per week must be a valid number"):(s.daysPerWeek<this.MIN_DAYS&&t.push(`Days per week must be at least ${this.MIN_DAYS}`),s.daysPerWeek>this.MAX_DAYS&&t.push(`Days per week cannot exceed ${this.MAX_DAYS}`)),{isValid:t.length===0,errors:t,warnings:r}}static validateUtilityItem(s){const t=[],r=[];return(!s.id||typeof s.id!="string")&&t.push("Utility ID is required"),(!s.type||!["electric","lpg","water"].includes(s.type))&&t.push('Type must be "electric", "lpg", or "water"'),(!s.device||typeof s.device!="string")&&t.push("Device name is required"),s.type==="electric"?(typeof s.kw!="number"||isNaN(s.kw)?t.push("KW rating is required for electric devices"):s.kw<=0&&t.push("KW rating must be greater than 0"),typeof s.hoursPerDay!="number"||isNaN(s.hoursPerDay)?t.push("Hours per day is required for electric devices"):(s.hoursPerDay<0||s.hoursPerDay>24)&&t.push("Hours per day must be between 0 and 24"),typeof s.ratePerKwh!="number"||isNaN(s.ratePerKwh)?t.push("Rate per KWh is required for electric devices"):s.ratePerKwh<0&&t.push("Rate per KWh cannot be negative")):s.type==="lpg"?(typeof s.kgPerBatch!="number"||isNaN(s.kgPerBatch)?t.push("KG per batch is required for LPG devices"):s.kgPerBatch<=0&&t.push("KG per batch must be greater than 0"),typeof s.batchesPerDay!="number"||isNaN(s.batchesPerDay)?t.push("Batches per day is required for LPG devices"):s.batchesPerDay<0&&t.push("Batches per day cannot be negative"),typeof s.ratePerKg!="number"||isNaN(s.ratePerKg)?t.push("Rate per KG is required for LPG devices"):s.ratePerKg<0&&t.push("Rate per KG cannot be negative")):s.type==="water"&&(typeof s.m3PerDay!="number"||isNaN(s.m3PerDay)?t.push("M3 per day is required for water devices"):s.m3PerDay<0&&t.push("M3 per day cannot be negative"),typeof s.ratePerM3!="number"||isNaN(s.ratePerM3)?t.push("Rate per M3 is required for water devices"):s.ratePerM3<0&&t.push("Rate per M3 cannot be negative")),{isValid:t.length===0,errors:t,warnings:r}}static validateFixedCost(s){const t=[],r=[];return(!s.id||typeof s.id!="string")&&t.push("Fixed cost ID is required"),(!s.name||typeof s.name!="string")&&t.push("Fixed cost name is required"),typeof s.amountPerMonth!="number"||isNaN(s.amountPerMonth)?t.push("Amount per month must be a valid number"):(s.amountPerMonth<0&&t.push("Amount per month cannot be negative"),s.amountPerMonth>1e5&&r.push(`Amount per month (${s.amountPerMonth} THB) seems high. Please verify.`)),{isValid:t.length===0,errors:t,warnings:r}}static validateAllData(s){const t=[],r=[];if(Array.isArray(s.menus)&&s.menus.forEach((n,i)=>{const l=this.validateMenuItem(n);l.errors.forEach(o=>t.push(`Menu ${i+1}: ${o}`)),l.warnings.forEach(o=>r.push(`Menu ${i+1}: ${o}`))}),s.salesModel){const n=this.validateSalesModel(s.salesModel);n.errors.forEach(i=>t.push(`Sales Model: ${i}`)),n.warnings.forEach(i=>r.push(`Sales Model: ${i}`))}return Array.isArray(s.labor)&&s.labor.forEach((n,i)=>{const l=this.validateLaborItem(n);l.errors.forEach(o=>t.push(`Labor ${i+1}: ${o}`)),l.warnings.forEach(o=>r.push(`Labor ${i+1}: ${o}`))}),Array.isArray(s.utilities)&&s.utilities.forEach((n,i)=>{const l=this.validateUtilityItem(n);l.errors.forEach(o=>t.push(`Utility ${i+1}: ${o}`)),l.warnings.forEach(o=>r.push(`Utility ${i+1}: ${o}`))}),Array.isArray(s.fixedCosts)&&s.fixedCosts.forEach((n,i)=>{const l=this.validateFixedCost(n);l.errors.forEach(o=>t.push(`Fixed Cost ${i+1}: ${o}`)),l.warnings.forEach(o=>r.push(`Fixed Cost ${i+1}: ${o}`))}),{isValid:t.length===0,errors:t,warnings:r}}}class Pn{state;financeEngine;subscribers=[];validationCache=new Map;constructor(){this.financeEngine=new ht,this.state=this.getInitialState(),this.initializeState()}getInitialState(){return{data:null,scenarios:{},currentScenario:"base",computationResult:null,validationResults:[],isLoading:!1,error:null,lastUpdated:new Date().toISOString()}}initializeState(){try{this.financeEngine.init();const s=this.financeEngine.getData(),t=this.financeEngine.getScenarios();this.updateState({type:"DATA_UPDATE",payload:{data:s,scenarios:t}}),this.computeAndValidate()}catch(s){this.updateState({type:"ERROR_UPDATE",payload:{error:`Failed to initialize: ${s.message}`}})}}updateState(s){try{const t={...this.state};switch(s.type){case"DATA_UPDATE":this.state.data=s.payload.data,this.state.scenarios=s.payload.scenarios;break;case"SCENARIO_UPDATE":this.state.currentScenario=s.payload.scenarioId;break;case"COMPUTATION_UPDATE":this.state.computationResult=s.payload.result;break;case"VALIDATION_UPDATE":this.state.validationResults=s.payload.results;break;case"ERROR_UPDATE":this.state.error=s.payload.error,this.state.isLoading=!1;break;case"LOADING_UPDATE":this.state.isLoading=s.payload.isLoading,s.payload.isLoading&&(this.state.error=null);break}this.state.lastUpdated=new Date().toISOString(),this.notifySubscribers(),s.type==="DATA_UPDATE"&&this.autoSave()}catch(t){console.error("Error updating state:",t),this.updateState({type:"ERROR_UPDATE",payload:{error:`State update failed: ${t.message}`}})}}subscribe(s){return this.subscribers.push(s),()=>{const t=this.subscribers.indexOf(s);t>-1&&this.subscribers.splice(t,1)}}notifySubscribers(){this.subscribers.forEach(s=>{try{s(this.state)}catch(t){console.error("Error in subscriber callback:",t)}})}updateMenu(s,t){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}});const r=ke.validateMenuItem(t);if(!r.isValid){this.updateState({type:"ERROR_UPDATE",payload:{error:`Menu validation failed: ${r.errors.join(", ")}`}});return}this.financeEngine.updateMenu(s,t);const n=this.financeEngine.getData();this.updateState({type:"DATA_UPDATE",payload:{data:n,scenarios:this.state.scenarios}}),this.computeAndValidate()}catch(r){this.updateState({type:"ERROR_UPDATE",payload:{error:`Failed to update menu: ${r.message}`}})}}updateSalesModel(s){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}});const t=ke.validateSalesModel(s);if(!t.isValid){this.updateState({type:"ERROR_UPDATE",payload:{error:`Sales model validation failed: ${t.errors.join(", ")}`}});return}this.financeEngine.updateSalesModel(s);const r=this.financeEngine.getData();this.updateState({type:"DATA_UPDATE",payload:{data:r,scenarios:this.state.scenarios}}),this.computeAndValidate()}catch(t){this.updateState({type:"ERROR_UPDATE",payload:{error:`Failed to update sales model: ${t.message}`}})}}updateUtilities(s){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}});const t=s.map(i=>ke.validateUtilityItem(i));if(t.some(i=>!i.isValid)){const i=t.filter(l=>!l.isValid).flatMap(l=>l.errors);this.updateState({type:"ERROR_UPDATE",payload:{error:`Utility validation failed: ${i.join(", ")}`}});return}this.financeEngine.updateUtilities(s);const n=this.financeEngine.getData();this.updateState({type:"DATA_UPDATE",payload:{data:n,scenarios:this.state.scenarios}}),this.computeAndValidate()}catch(t){this.updateState({type:"ERROR_UPDATE",payload:{error:`Failed to update utilities: ${t.message}`}})}}updateLabor(s){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}});const t=s.map(i=>ke.validateLaborItem(i));if(t.some(i=>!i.isValid)){const i=t.filter(l=>!l.isValid).flatMap(l=>l.errors);this.updateState({type:"ERROR_UPDATE",payload:{error:`Labor validation failed: ${i.join(", ")}`}});return}this.financeEngine.updateLabor(s);const n=this.financeEngine.getData();this.updateState({type:"DATA_UPDATE",payload:{data:n,scenarios:this.state.scenarios}}),this.computeAndValidate()}catch(t){this.updateState({type:"ERROR_UPDATE",payload:{error:`Failed to update labor: ${t.message}`}})}}updateFixedCosts(s){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}});const t=s.map(i=>ke.validateFixedCost(i));if(t.some(i=>!i.isValid)){const i=t.filter(l=>!l.isValid).flatMap(l=>l.errors);this.updateState({type:"ERROR_UPDATE",payload:{error:`Fixed cost validation failed: ${i.join(", ")}`}});return}this.financeEngine.updateFixedCosts(s);const n=this.financeEngine.getData();this.updateState({type:"DATA_UPDATE",payload:{data:n,scenarios:this.state.scenarios}}),this.computeAndValidate()}catch(t){this.updateState({type:"ERROR_UPDATE",payload:{error:`Failed to update fixed costs: ${t.message}`}})}}computeAndValidate(){try{const s=this.financeEngine.compute();this.updateState({type:"COMPUTATION_UPDATE",payload:{result:s}}),this.validateAllData(),this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!1}})}catch(s){this.updateState({type:"ERROR_UPDATE",payload:{error:`Computation failed: ${s.message}`}})}}validateAllData(){try{const s=JSON.stringify(this.state.data),t=this.validationCache.get(s);if(t){this.updateState({type:"VALIDATION_UPDATE",payload:{results:[t]}});return}const r=ke.validateAllData(this.state.data);this.validationCache.set(s,r),this.updateState({type:"VALIDATION_UPDATE",payload:{results:[r]}})}catch(s){console.error("Validation failed:",s)}}importData(s){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}});const t=this.financeEngine.importJSON(s);if(t.success){const r=this.financeEngine.getData(),n=this.financeEngine.getScenarios();this.updateState({type:"DATA_UPDATE",payload:{data:r,scenarios:n}}),this.computeAndValidate(),this.validationCache.clear()}else this.updateState({type:"ERROR_UPDATE",payload:{error:t.error||"Import failed"}});return t}catch(t){return this.updateState({type:"ERROR_UPDATE",payload:{error:`Import failed: ${t.message}`}}),{success:!1,error:t.message}}}exportData(){try{return this.financeEngine.exportJSON()}catch(s){throw console.error("Export failed:",s),s}}autoSave(){try{this.financeEngine.save()}catch(s){console.error("Auto-save failed:",s)}}getState(){return{...this.state}}getData(){return this.state.data}getComputationResult(){return this.state.computationResult}getValidationResults(){return this.state.validationResults}getError(){return this.state.error}isLoading(){return this.state.isLoading}setCurrentScenario(s){this.state.scenarios[s]?this.updateState({type:"SCENARIO_UPDATE",payload:{scenarioId:s}}):this.updateState({type:"ERROR_UPDATE",payload:{error:`Scenario ${s} not found`}})}getCurrentScenario(){return this.state.currentScenario}getScenarios(){return this.state.scenarios}clearError(){this.updateState({type:"ERROR_UPDATE",payload:{error:null}})}reset(){try{this.updateState({type:"LOADING_UPDATE",payload:{isLoading:!0}}),localStorage.removeItem("finance_data"),localStorage.removeItem("finance_scenarios"),this.financeEngine=new ht,this.financeEngine.init();const s=this.financeEngine.getData(),t=this.financeEngine.getScenarios();this.updateState({type:"DATA_UPDATE",payload:{data:s,scenarios:t}}),this.computeAndValidate(),this.validationCache.clear()}catch(s){this.updateState({type:"ERROR_UPDATE",payload:{error:`Reset failed: ${s.message}`}})}}}let js=null;const vs=()=>(js||(js=new Pn),js),de=()=>{const[a,s]=v.useState(()=>vs().getState()),t=v.useRef(null);v.useEffect(()=>{const i=vs();return t.current=i.subscribe(l=>{s(l)}),()=>{t.current&&t.current()}},[]);const r=vs(),n={updateMenu:v.useCallback((i,l)=>{r.updateMenu(i,l)},[r]),updateSalesModel:v.useCallback(i=>{r.updateSalesModel(i)},[r]),updateUtilities:v.useCallback(i=>{r.updateUtilities(i)},[r]),updateLabor:v.useCallback(i=>{r.updateLabor(i)},[r]),updateFixedCosts:v.useCallback(i=>{r.updateFixedCosts(i)},[r]),importData:v.useCallback(i=>r.importData(i),[r]),exportData:v.useCallback(()=>r.exportData(),[r]),setCurrentScenario:v.useCallback(i=>{r.setCurrentScenario(i)},[r]),clearError:v.useCallback(()=>{r.clearError()},[r]),reset:v.useCallback(()=>{r.reset()},[r])};return{...a,...n}},Cn=()=>{const{validationResults:a,isLoading:s,error:t}=de(),r=a.some(o=>!o.isValid),n=a.some(o=>o.warnings.length>0),i=a.flatMap(o=>o.errors),l=a.flatMap(o=>o.warnings);return{validationResults:a,hasErrors:r,hasWarnings:n,allErrors:i,allWarnings:l,isLoading:s,error:t}};function Sn(){const{data:a,updateSalesModel:s}=de(),[t,r]=v.useState(()=>a?.salesModel||{}),[n,i]=v.useState(t.forecastDailyUnits),[l,o]=v.useState(t.paymentFeePercent),[d,m]=v.useState(t.deliveryCommissionPercent),b=["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],C=(S,j)=>{const u={...t.seasonality,[S]:j/100},c={...t,seasonality:u};r(c),financeEngine.updateSalesModel(c),onUpdate()},f=S=>{i(S);const j={...t,forecastDailyUnits:S};r(j),s(j)},w=S=>{o(S);const j={...t,paymentFeePercent:S};r(j),s(j)},k=S=>{m(S);const j={...t,deliveryCommissionPercent:S};r(j),s(j)},T=S=>{const j=t.seasonality[S]||1;return Math.round(n*30*j)},E=S=>T(S)*60;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"โมเดลยอดขาย"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการการคาดการณ์ยอดขายและค่าธรรมเนียม"})]}),e.jsxs(q,{variant:"outline",children:["รายได้เดือนละ ",g(E("Jan"))]})]}),e.jsxs(we,{defaultValue:"forecast",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(G,{value:"forecast",children:"คาดการณ์ยอดขาย"}),e.jsx(G,{value:"seasonality",children:"ปรับปรุงตามฤดูกาล"}),e.jsx(G,{value:"channels",children:"ช่องทางและค่าธรรมเนียม"}),e.jsx(G,{value:"schedule",children:"เวลาดำเนินการ"})]}),e.jsx(H,{value:"forecast",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"การคาดการณ์ยอดขายรายวัน"]}),e.jsx(I,{children:"ตั้งค่าจำนวนจานที่คาดว่าจะขายได้ต่อวัน"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"daily-forecast",children:"จำนวนจานต่อวัน"}),e.jsx(B,{id:"daily-forecast",type:"number",value:n,onChange:S=>f(Ke(S.target.value)),placeholder:"120"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ยอดขายเฉลี่ยต่อวันที่คาดการณ์"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"ปรับด้วย Slider"}),e.jsx(ye,{value:[n],onValueChange:S=>f(S[0]),max:300,min:50,step:10,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:"50 จาน"}),e.jsx("span",{children:"300 จาน"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"รายวัน"}),e.jsxs("div",{className:"text-xl font-bold",children:[n," จาน"]})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"รายสัปดาห์"}),e.jsxs("div",{className:"text-xl font-bold",children:[n*7," จาน"]})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"รายเดือน"}),e.jsxs("div",{className:"text-xl font-bold",children:[n*30," จาน"]})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"รายปี"}),e.jsxs("div",{className:"text-xl font-bold",children:[n*365," จาน"]})]})]})]})]})}),e.jsx(H,{value:"seasonality",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5"}),"ปรับปรุงตามฤดูกาล"]}),e.jsx(I,{children:"ตั้งค่าการเปลี่ยนแปลงยอดขายในแต่ละเดือน (100% = ปกติ)"})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map((S,j)=>{const u=Math.round((t.seasonality[S]||1)*100);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(R,{className:"text-sm",children:b[j]}),e.jsxs(q,{variant:u>100?"default":u<90?"destructive":"secondary",children:[u,"%"]})]}),e.jsx(ye,{value:[u],onValueChange:c=>C(S,c[0]),max:150,min:50,step:5,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[T(S)," จาน"]}),e.jsx("span",{children:g(E(S))})]})]},S)})})})]})}),e.jsx(H,{value:"channels",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(sr,{className:"w-5 h-5"}),"ค่าธรรมเนียมการชำระเงิน"]}),e.jsx(I,{children:"ค่าธรรมเนียมบัตรเครดิต/QR Payment"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"payment-fee",children:"ค่าธรรมเนียม (%)"}),e.jsx(B,{id:"payment-fee",type:"number",step:"0.1",value:l,onChange:S=>w(parseFloat(S.target.value)||0),placeholder:"1.5"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ค่าธรรมเนียมเฉลี่ยของการชำระเงินแบบไม่ใช้เงินสด"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"ผลกระทบต่อรายได้"}),e.jsxs("div",{className:"text-lg font-bold text-red-600",children:["-",g(E("Jan")*l/100)," /เดือน"]})]})]})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(tr,{className:"w-5 h-5"}),"ค่าคอมมิชชันเดลิเวอรี"]}),e.jsx(I,{children:"ค่าคอมมิชชันแพลตฟอร์มเดลิเวอรี"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"delivery-commission",children:"ค่าคอมมิชชัน (%)"}),e.jsx(B,{id:"delivery-commission",type:"number",step:"0.1",value:d,onChange:S=>k(parseFloat(S.target.value)||0),placeholder:"25"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ค่าคอมมิชชันของแพลตฟอร์มเดลิเวอรี (Grab, Foodpanda)"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"ผลกระทบยอดเดลิเวอรี"}),e.jsxs("div",{className:"text-lg font-bold text-red-600",children:["-",g(E("Jan")*.1*d/100)," /เดือน"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"สมมติเดลิเวอรี 10% ของยอดขาย"})]})]})]})]})}),e.jsx(H,{value:"schedule",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"w-5 h-5"}),"เวลาดำเนินการ"]}),e.jsx(I,{children:"ตั้งค่าวันและเวลาเปิด-ปิดร้าน"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{children:"วันเปิดทำการ"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์","อาทิตย์"].map((S,j)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`day-${j}`,defaultChecked:j<6,className:"rounded border-gray-300"}),e.jsx(R,{htmlFor:`day-${j}`,className:"text-sm",children:S})]},S))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"open-time",children:"เวลาเปิด"}),e.jsx(B,{id:"open-time",type:"time",defaultValue:"07:00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"close-time",children:"เวลาปิด"}),e.jsx(B,{id:"close-time",type:"time",defaultValue:"15:00"})]})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"ข้อมูลสรุป"}),e.jsx("div",{className:"text-sm text-blue-700",children:"เปิดทำการ 6 วัน/สัปดาห์ × 8 ชั่วโมง/วัน = 48 ชั่วโมง/สัปดาห์"})]})]})]})})]})]})}function pe({className:a,...s}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:U("w-full caption-bottom text-sm",a),...s})})}function ge({className:a,...s}){return e.jsx("thead",{"data-slot":"table-header",className:U("[&_tr]:border-b",a),...s})}function fe({className:a,...s}){return e.jsx("tbody",{"data-slot":"table-body",className:U("[&_tr:last-child]:border-0",a),...s})}function Y({className:a,...s}){return e.jsx("tr",{"data-slot":"table-row",className:U("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...s})}function F({className:a,...s}){return e.jsx("th",{"data-slot":"table-head",className:U("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})}function N({className:a,...s}){return e.jsx("td",{"data-slot":"table-cell",className:U("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})}function Ee({...a}){return e.jsx(kt,{"data-slot":"dialog",...a})}function Re({...a}){return e.jsx(Dt,{"data-slot":"dialog-trigger",...a})}function kn({...a}){return e.jsx(Rt,{"data-slot":"dialog-portal",...a})}function Dn({className:a,...s}){return e.jsx(Tt,{"data-slot":"dialog-overlay",className:U("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...s})}function Te({className:a,children:s,...t}){return e.jsxs(kn,{"data-slot":"dialog-portal",children:[e.jsx(Dn,{}),e.jsxs(Mt,{"data-slot":"dialog-content",className:U("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...t,children:[s,e.jsxs(Us,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Be,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Oe({className:a,...s}){return e.jsx("div",{"data-slot":"dialog-header",className:U("flex flex-col gap-2 text-center sm:text-left",a),...s})}function _e({className:a,...s}){return e.jsx("div",{"data-slot":"dialog-footer",className:U("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...s})}function Fe({className:a,...s}){return e.jsx(At,{"data-slot":"dialog-title",className:U("text-lg leading-none font-semibold",a),...s})}function Ye({className:a,...s}){return e.jsx(Et,{"data-slot":"dialog-description",className:U("text-muted-foreground text-sm",a),...s})}function Mn(){const{data:a}=de(),[s,t]=v.useState(()=>a?.menus||[]),[r,n]=v.useState(s[0]||null),[i,l]=v.useState(!1),[o,d]=v.useState(!1),[m,b]=v.useState(null),[p,C]=v.useState({name:"",price:0,channelMix:{dineIn:70,takeaway:20,delivery:10}}),[f,w]=v.useState({item:"",qtyG:0,unitCostPerKg:0,yieldPercent:100,wastePercent:0}),k=x=>{if(x.packaging)return x.packaging.qtyUnit*x.packaging.unitCost;const y=x.yieldPercent/100,W=1+x.wastePercent/100;return x.qtyG/1e3*W/y*x.unitCostPerKg},T=x=>x.reduce((y,W)=>y+k(W),0),E=x=>{const y=T(x.bom);return x.price-y},S=x=>E(x)/x.price*100,j=()=>{const y={id:`menu_${Date.now()}`,name:p.name,price:p.price,channelMix:{dineIn:p.channelMix.dineIn/100,takeaway:p.channelMix.takeaway/100,delivery:p.channelMix.delivery/100},bom:[]},W=[...s,y];t(W),financeEngine.getData().menus=W,financeEngine.save(),onUpdate(),C({name:"",price:0,channelMix:{dineIn:70,takeaway:20,delivery:10}}),l(!1),n(y)},u=()=>{if(!r)return;const x=m!==null?r.bom.map((K,X)=>X===m?f:K):[...r.bom,f],y={...r,bom:x},W=s.map(K=>K.id===r.id?y:K);t(W),n(y),financeEngine.getData().menus=W,financeEngine.save(),onUpdate(),w({item:"",qtyG:0,unitCostPerKg:0,yieldPercent:100,wastePercent:0}),b(null),d(!1)},c=x=>{r&&(w(r.bom[x]),b(x),d(!0))},h=x=>{if(!r)return;const y=r.bom.filter((X,me)=>me!==x),W={...r,bom:y},K=s.map(X=>X.id===r.id?W:X);t(K),n(W),financeEngine.getData().menus=K,financeEngine.save(),onUpdate()},D=x=>x>=60?"default":x>=40?"secondary":"destructive";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"เมนูและสูตรอาหาร (BOM)"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการรายการอาหารและคำนวณต้นทุนวัตถุดิบ"})]}),e.jsxs(Ee,{open:i,onOpenChange:l,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(O,{children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"เพิ่มเมนูใหม่"]})}),e.jsxs(Te,{children:[e.jsxs(Oe,{children:[e.jsx(Fe,{children:"เพิ่มเมนูใหม่"}),e.jsx(Ye,{children:"กรอกข้อมูลเมนูอาหารใหม่"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"menu-name",children:"ชื่อเมนู"}),e.jsx(B,{id:"menu-name",value:p.name,onChange:x=>C(y=>({...y,name:x.target.value})),placeholder:"ข้าวมันไก่"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"menu-price",children:"ราคาขาย (บาท)"}),e.jsx(B,{id:"menu-price",type:"number",value:p.price,onChange:x=>C(y=>({...y,price:Ke(x.target.value)})),placeholder:"60"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Dine-in (%)"}),e.jsx(B,{type:"number",value:p.channelMix.dineIn,onChange:x=>C(y=>({...y,channelMix:{...y.channelMix,dineIn:parseFloat(x.target.value)||0}}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Takeaway (%)"}),e.jsx(B,{type:"number",value:p.channelMix.takeaway,onChange:x=>C(y=>({...y,channelMix:{...y.channelMix,takeaway:parseFloat(x.target.value)||0}}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Delivery (%)"}),e.jsx(B,{type:"number",value:p.channelMix.delivery,onChange:x=>C(y=>({...y,channelMix:{...y.channelMix,delivery:parseFloat(x.target.value)||0}}))})]})]})]}),e.jsx(_e,{children:e.jsx(O,{onClick:j,children:"เพิ่มเมนู"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(P,{children:[e.jsx(z,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ar,{className:"w-5 h-5"}),"รายการเมนู"]})}),e.jsx($,{children:e.jsx("div",{className:"space-y-2",children:s.map(x=>e.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${r?.id===x.id?"border-primary bg-primary/5":"border-border hover:bg-muted"}`,onClick:()=>n(x),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:x.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g(x.price)})]}),e.jsxs(q,{variant:D(S(x)),children:["CM ",S(x).toFixed(1),"%"]})]})},x.id))})})]}),e.jsxs(P,{className:"lg:col-span-2",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(rr,{className:"w-5 h-5"}),r?`สูตร: ${r.name}`:"เลือกเมนู"]}),r&&e.jsxs(I,{children:["ราคาขาย ",g(r.price)," | ต้นทุน ",g(T(r.bom))," | CM ",g(E(r))]})]}),r&&e.jsxs(Ee,{open:o,onOpenChange:d,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(O,{size:"sm",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"เพิ่มวัตถุดิบ"]})}),e.jsxs(Te,{className:"max-w-2xl",children:[e.jsx(Oe,{children:e.jsx(Fe,{children:m!==null?"แก้ไขวัตถุดิบ":"เพิ่มวัตถุดิบใหม่"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"item-name",children:"ชื่อวัตถุดิบ"}),e.jsx(B,{id:"item-name",value:f.item,onChange:x=>w(y=>({...y,item:x.target.value})),placeholder:"น่องไก่"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"qty",children:"ปริมาณ (กรัม)"}),e.jsx(B,{id:"qty",type:"number",value:f.qtyG,onChange:x=>w(y=>({...y,qtyG:Ke(x.target.value)})),placeholder:"120"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"unit-cost",children:"ราคาต่อกิโลกรัม (บาท)"}),e.jsx(B,{id:"unit-cost",type:"number",value:f.unitCostPerKg,onChange:x=>w(y=>({...y,unitCostPerKg:Ke(x.target.value)})),placeholder:"70"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"yield",children:"Yield (%)"}),e.jsx(B,{id:"yield",type:"number",value:f.yieldPercent,onChange:x=>w(y=>({...y,yieldPercent:parseFloat(x.target.value)||100})),placeholder:"85"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"waste",children:"Waste (%)"}),e.jsx(B,{id:"waste",type:"number",value:f.wastePercent,onChange:x=>w(y=>({...y,wastePercent:parseFloat(x.target.value)||0})),placeholder:"5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"ต้นทุนคำนวณ"}),e.jsx("div",{className:"text-lg font-bold text-primary",children:g(k(f))})]})]}),e.jsx(_e,{children:e.jsx(O,{onClick:u,children:m!==null?"บันทึกการแก้ไข":"เพิ่มวัตถุดิบ"})})]})]})]})}),e.jsx($,{children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"วัตถุดิบ"}),e.jsx(F,{className:"text-right",children:"ปริมาณ (กรัม)"}),e.jsx(F,{className:"text-right",children:"ราคา/กก."}),e.jsx(F,{className:"text-right",children:"Yield %"}),e.jsx(F,{className:"text-right",children:"Waste %"}),e.jsx(F,{className:"text-right",children:"ต้นทุน"}),e.jsx(F,{className:"text-right",children:"การดำเนินการ"})]})}),e.jsx(fe,{children:r.bom.map((x,y)=>e.jsxs(Y,{children:[e.jsx(N,{className:"font-medium",children:x.item}),e.jsx(N,{className:"text-right",children:x.qtyG}),e.jsx(N,{className:"text-right",children:g(x.unitCostPerKg)}),e.jsxs(N,{className:"text-right",children:[x.yieldPercent,"%"]}),e.jsxs(N,{className:"text-right",children:[x.wastePercent,"%"]}),e.jsx(N,{className:"text-right font-medium",children:g(k(x))}),e.jsx(N,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>c(y),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>h(y),children:e.jsx(ie,{className:"w-3 h-3"})})]})})]},y))})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"ต้นทุนรวม"}),e.jsx("div",{className:"text-xl font-bold",children:g(T(r.bom))})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Contribution Margin"}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:g(E(r))})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"CM %"}),e.jsxs("div",{className:"text-xl font-bold",children:[S(r).toFixed(1),"%"]})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Food Cost %"}),e.jsxs("div",{className:"text-xl font-bold",children:[(T(r.bom)/r.price*100).toFixed(1),"%"]})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"กรุณาเลือกเมนูเพื่อดูรายละเอียดสูตรอาหาร"})})]})]})]})}function Ge({...a}){return e.jsx(_a,{"data-slot":"select",...a})}function He({...a}){return e.jsx(za,{"data-slot":"select-value",...a})}function We({className:a,size:s="default",children:t,...r}){return e.jsxs(Fa,{"data-slot":"select-trigger","data-size":s,className:U("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...r,children:[t,e.jsx(Ua,{asChild:!0,children:e.jsx(Ft,{className:"size-4 opacity-50"})})]})}function qe({className:a,children:s,position:t="popper",...r}){return e.jsx(La,{children:e.jsxs($a,{"data-slot":"select-content",className:U("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:t,...r,children:[e.jsx(An,{}),e.jsx(Va,{className:U("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),e.jsx(En,{})]})})}function re({className:a,children:s,...t}){return e.jsxs(Ia,{"data-slot":"select-item",className:U("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),...t,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Ba,{children:e.jsx(nr,{className:"size-4"})})}),e.jsx(Ka,{children:s})]})}function An({className:a,...s}){return e.jsx(Ga,{"data-slot":"select-scroll-up-button",className:U("flex cursor-default items-center justify-center py-1",a),...s,children:e.jsx(ir,{className:"size-4"})})}function En({className:a,...s}){return e.jsx(Ha,{"data-slot":"select-scroll-down-button",className:U("flex cursor-default items-center justify-center py-1",a),...s,children:e.jsx(Ft,{className:"size-4"})})}function Rn(){const{data:a}=de(),[s,t]=v.useState(()=>a?.utilities||[]),[r,n]=v.useState(!1),[i,l]=v.useState(null),[o,d]=v.useState({id:"",type:"electric",device:"",kw:0,hoursPerDay:0,ratePerKwh:5}),m=()=>{d({id:"",type:"electric",device:"",kw:0,hoursPerDay:0,ratePerKwh:5})},b=c=>c.type==="electric"&&c.kw&&c.hoursPerDay&&c.ratePerKwh?c.kw*c.hoursPerDay*c.ratePerKwh:c.type==="lpg"&&c.kgPerBatch&&c.batchesPerDay&&c.ratePerKg?c.kgPerBatch*c.batchesPerDay*c.ratePerKg:c.type==="water"&&c.m3PerDay&&c.ratePerM3?c.m3PerDay*c.ratePerM3:0,p=c=>b(c)*30,C=()=>s.reduce((c,h)=>c+p(h),0),f=()=>{const c=o.id||`utility_${Date.now()}`,h={...o,id:c},D=i!==null?s.map((x,y)=>y===i?h:x):[...s,h];t(D),financeEngine.updateUtilities(D),onUpdate(),m(),l(null),n(!1)},w=c=>{d(s[c]),l(c),n(!0)},k=c=>{const h=s.filter((D,x)=>x!==c);t(h),financeEngine.updateUtilities(h),onUpdate()},T=c=>{switch(c){case"electric":return e.jsx(is,{className:"w-4 h-4"});case"lpg":return e.jsx(Ys,{className:"w-4 h-4"});case"water":return e.jsx(Xs,{className:"w-4 h-4"});default:return e.jsx(is,{className:"w-4 h-4"})}},E=c=>{const h={electric:"bg-yellow-100 text-yellow-800",lpg:"bg-orange-100 text-orange-800",water:"bg-blue-100 text-blue-800"},D={electric:"ไฟฟ้า",lpg:"แก๊ส LPG",water:"น้ำประปา"};return e.jsx(q,{className:h[c]||h.electric,children:D[c]||"ไฟฟ้า"})},S=s.filter(c=>c.type==="electric"),j=s.filter(c=>c.type==="lpg"),u=s.filter(c=>c.type==="water");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"สาธารณูปโภค"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการต้นทุนไฟฟ้า แก๊ส และน้ำประปา"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"ต้นทุนรวม/เดือน"}),e.jsx("div",{className:"text-xl font-bold",children:g(C())})]}),e.jsxs(Ee,{open:r,onOpenChange:n,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(O,{onClick:()=>{m(),l(null)},children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"เพิ่มรายการ"]})}),e.jsxs(Te,{className:"max-w-2xl",children:[e.jsxs(Oe,{children:[e.jsx(Fe,{children:i!==null?"แก้ไขรายการสาธารณูปโภค":"เพิ่มรายการสาธารณูปโภค"}),e.jsx(Ye,{children:"กรอกข้อมูลการใช้งานและอัตราค่าบริการ"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"device",children:"ชื่ออุปกรณ์/บริการ"}),e.jsx(B,{id:"device",value:o.device,onChange:c=>d(h=>({...h,device:c.target.value})),placeholder:"เครื่องปรับอากาศ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"type",children:"ประเภท"}),e.jsxs(Ge,{value:o.type,onValueChange:c=>d(h=>({...h,type:c})),children:[e.jsx(We,{children:e.jsx(He,{})}),e.jsxs(qe,{children:[e.jsx(re,{value:"electric",children:"ไฟฟ้า"}),e.jsx(re,{value:"lpg",children:"แก๊ส LPG"}),e.jsx(re,{value:"water",children:"น้ำประปา"})]})]})]})]}),o.type==="electric"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"kw",children:"กำลังไฟ (kW)"}),e.jsx(B,{id:"kw",type:"number",step:"0.1",value:o.kw||"",onChange:c=>d(h=>({...h,kw:parseFloat(c.target.value)||0})),placeholder:"2.5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"hours",children:"ชั่วโมง/วัน"}),e.jsx(B,{id:"hours",type:"number",value:o.hoursPerDay||"",onChange:c=>d(h=>({...h,hoursPerDay:parseFloat(c.target.value)||0})),placeholder:"6"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"rate-kwh",children:"อัตรา บาท/kWh"}),e.jsx(B,{id:"rate-kwh",type:"number",step:"0.01",value:o.ratePerKwh||"",onChange:c=>d(h=>({...h,ratePerKwh:parseFloat(c.target.value)||0})),placeholder:"5.00"})]})]}),o.type==="lpg"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"kg-batch",children:"กก./batch"}),e.jsx(B,{id:"kg-batch",type:"number",step:"0.01",value:o.kgPerBatch||"",onChange:c=>d(h=>({...h,kgPerBatch:parseFloat(c.target.value)||0})),placeholder:"0.25"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"batches",children:"batch/วัน"}),e.jsx(B,{id:"batches",type:"number",value:o.batchesPerDay||"",onChange:c=>d(h=>({...h,batchesPerDay:parseFloat(c.target.value)||0})),placeholder:"2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"rate-kg",children:"อัตรา บาท/กก."}),e.jsx(B,{id:"rate-kg",type:"number",step:"0.01",value:o.ratePerKg||"",onChange:c=>d(h=>({...h,ratePerKg:parseFloat(c.target.value)||0})),placeholder:"29.33"})]})]}),o.type==="water"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"m3-day",children:"ลูกบาศก์เมตร/วัน"}),e.jsx(B,{id:"m3-day",type:"number",step:"0.1",value:o.m3PerDay||"",onChange:c=>d(h=>({...h,m3PerDay:parseFloat(c.target.value)||0})),placeholder:"0.2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"rate-m3",children:"อัตรา บาท/ลบ.ม."}),e.jsx(B,{id:"rate-m3",type:"number",step:"0.01",value:o.ratePerM3||"",onChange:c=>d(h=>({...h,ratePerM3:parseFloat(c.target.value)||0})),placeholder:"14.00"})]})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"การคำนวณต้นทุน"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ต้นทุน/วัน:"}),e.jsx("div",{className:"font-bold",children:g(b(o))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ต้นทุน/เดือน:"}),e.jsx("div",{className:"font-bold",children:g(p(o))})]})]})]})]}),e.jsx(_e,{children:e.jsx(O,{onClick:f,children:i!==null?"บันทึกการแก้ไข":"เพิ่มรายการ"})})]})]})]})]}),e.jsxs(we,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(G,{value:"all",children:"ทั้งหมด"}),e.jsxs(G,{value:"electric",children:["ไฟฟ้า (",S.length,")"]}),e.jsxs(G,{value:"lpg",children:["แก๊ส (",j.length,")"]}),e.jsxs(G,{value:"water",children:["น้ำประปา (",u.length,")"]})]}),e.jsx(H,{value:"all",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"รายการสาธารณูปโภคทั้งหมด"}),e.jsxs(I,{children:["ต้นทุนรวมทั้งหมด ",g(C())," ต่อเดือน"]})]}),e.jsx($,{children:e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"อุปกรณ์/บริการ"}),e.jsx(F,{children:"ประเภท"}),e.jsx(F,{className:"text-right",children:"การใช้งาน"}),e.jsx(F,{className:"text-right",children:"อัตรา"}),e.jsx(F,{className:"text-right",children:"ต้นทุน/วัน"}),e.jsx(F,{className:"text-right",children:"ต้นทุน/เดือน"}),e.jsx(F,{className:"text-right",children:"การดำเนินการ"})]})}),e.jsx(fe,{children:s.map((c,h)=>e.jsxs(Y,{children:[e.jsx(N,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[T(c.type),c.device]})}),e.jsx(N,{children:E(c.type)}),e.jsxs(N,{className:"text-right",children:[c.type==="electric"&&`${c.kw} kW × ${c.hoursPerDay} ชม.`,c.type==="lpg"&&`${c.kgPerBatch} กก. × ${c.batchesPerDay} batch`,c.type==="water"&&`${c.m3PerDay} ลบ.ม./วัน`]}),e.jsxs(N,{className:"text-right",children:[c.type==="electric"&&`${c.ratePerKwh} บาท/kWh`,c.type==="lpg"&&`${c.ratePerKg} บาท/กก.`,c.type==="water"&&`${c.ratePerM3} บาท/ลบ.ม.`]}),e.jsx(N,{className:"text-right font-medium",children:g(b(c))}),e.jsx(N,{className:"text-right font-bold",children:g(p(c))}),e.jsx(N,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>w(h),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>k(h),children:e.jsx(ie,{className:"w-3 h-3"})})]})})]},c.id))})]})})]})}),e.jsx(H,{value:"electric",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-5 h-5"}),"ไฟฟ้า"]}),e.jsxs(I,{children:["ต้นทุนไฟฟ้ารวม ",g(S.reduce((c,h)=>c+p(h),0))," ต่อเดือน"]})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:S.map((c,h)=>e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:c.device}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>w(s.indexOf(c)),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>k(s.indexOf(c)),children:e.jsx(ie,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["กำลังไฟ: ",c.kw," kW"]}),e.jsxs("div",{children:["ใช้งาน: ",c.hoursPerDay," ชั่วโมง/วัน"]}),e.jsxs("div",{children:["อัตรา: ",c.ratePerKwh," บาท/kWh"]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"ต้นทุน/เดือน:"}),e.jsx("span",{className:"font-bold",children:g(p(c))})]})})]},c.id))})})]})}),e.jsx(H,{value:"lpg",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ys,{className:"w-5 h-5"}),"แก๊ส LPG"]}),e.jsxs(I,{children:["ต้นทุนแก๊สรวม ",g(j.reduce((c,h)=>c+p(h),0))," ต่อเดือน"]})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:j.map(c=>e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:c.device}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>w(s.indexOf(c)),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>k(s.indexOf(c)),children:e.jsx(ie,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["การใช้: ",c.kgPerBatch," กก./batch"]}),e.jsxs("div",{children:["จำนวน: ",c.batchesPerDay," batch/วัน"]}),e.jsxs("div",{children:["อัตรา: ",c.ratePerKg," บาท/กก."]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"ต้นทุน/เดือน:"}),e.jsx("span",{className:"font-bold",children:g(p(c))})]})})]},c.id))})})]})}),e.jsx(H,{value:"water",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"w-5 h-5"}),"น้ำประปา"]}),e.jsxs(I,{children:["ต้นทุนน้ำรวม ",g(u.reduce((c,h)=>c+p(h),0))," ต่อเดือน"]})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(c=>e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:c.device}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>w(s.indexOf(c)),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>k(s.indexOf(c)),children:e.jsx(ie,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["การใช้: ",c.m3PerDay," ลูกบาศก์เมตร/วัน"]}),e.jsxs("div",{children:["อัตรา: ",c.ratePerM3," บาท/ลบ.ม."]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"ต้นทุน/เดือน:"}),e.jsx("span",{className:"font-bold",children:g(p(c))})]})})]},c.id))})})]})})]})]})}function Tn(){const{data:a}=de(),[s,t]=v.useState(()=>a?.labor||[]),[r,n]=v.useState(!1),[i,l]=v.useState(null),[o,d]=v.useState({id:"",role:"",type:"direct",wagePerHour:45,hoursPerDay:8,daysPerWeek:6}),m=()=>{d({id:"",role:"",type:"direct",wagePerHour:45,hoursPerDay:8,daysPerWeek:6})},b=h=>h.wagePerHour*h.hoursPerDay,p=h=>b(h)*h.daysPerWeek,C=h=>p(h)*4.33,f=()=>s.reduce((h,D)=>h+C(D),0),w=()=>s.filter(h=>h.type==="direct").reduce((h,D)=>h+C(D),0),k=()=>s.filter(h=>h.type==="indirect").reduce((h,D)=>h+C(D),0),T=()=>{const h=o.id||`labor_${Date.now()}`,D={...o,id:h},x=i!==null?s.map((y,W)=>W===i?D:y):[...s,D];t(x),financeEngine.updateLabor(x),onUpdate(),m(),l(null),n(!1)},E=h=>{d(s[h]),l(h),n(!0)},S=h=>{const D=s.filter((x,y)=>y!==h);t(D),financeEngine.updateLabor(D),onUpdate()},j=h=>h==="direct"?e.jsx(q,{className:"bg-green-100 text-green-800",children:"แรงงานโดยตรง"}):e.jsx(q,{className:"bg-blue-100 text-blue-800",children:"แรงงานทางอ้อม"}),u=s.filter(h=>h.type==="direct"),c=s.filter(h=>h.type==="indirect");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"แรงงาน"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการต้นทุนแรงงานและตารางงาน"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"ต้นทุนรวม/เดือน"}),e.jsx("div",{className:"text-xl font-bold",children:g(f())})]}),e.jsxs(Ee,{open:r,onOpenChange:n,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(O,{onClick:()=>{m(),l(null)},children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"เพิ่มพนักงาน"]})}),e.jsxs(Te,{className:"max-w-2xl",children:[e.jsxs(Oe,{children:[e.jsx(Fe,{children:i!==null?"แก้ไขข้อมูลพนักงาน":"เพิ่มพนักงานใหม่"}),e.jsx(Ye,{children:"กรอกข้อมูลตำแหน่งงาน ค่าจ้าง และตารางงาน"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"role",children:"ตำแหน่งงาน"}),e.jsx(B,{id:"role",value:o.role,onChange:h=>d(D=>({...D,role:h.target.value})),placeholder:"พ่อครัว, แคชเชียร์, ผู้ช่วย"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"type",children:"ประเภทแรงงาน"}),e.jsxs(Ge,{value:o.type,onValueChange:h=>d(D=>({...D,type:h})),children:[e.jsx(We,{children:e.jsx(He,{})}),e.jsxs(qe,{children:[e.jsx(re,{value:"direct",children:"แรงงานโดยตรง (เกี่ยวข้องการผลิต)"}),e.jsx(re,{value:"indirect",children:"แรงงานทางอ้อม (บริหาร/ขาย)"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"wage",children:"ค่าจ้าง/ชั่วโมง (บาท)"}),e.jsx(B,{id:"wage",type:"number",step:"0.5",value:o.wagePerHour,onChange:h=>d(D=>({...D,wagePerHour:parseFloat(h.target.value)||0})),placeholder:"45"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"hours",children:"ชั่วโมง/วัน"}),e.jsx(B,{id:"hours",type:"number",value:o.hoursPerDay,onChange:h=>d(D=>({...D,hoursPerDay:parseFloat(h.target.value)||0})),placeholder:"8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"days",children:"วัน/สัปดาห์"}),e.jsx(B,{id:"days",type:"number",value:o.daysPerWeek,onChange:h=>d(D=>({...D,daysPerWeek:parseFloat(h.target.value)||0})),placeholder:"6"})]})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"การคำนวณค่าจ้าง"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"รายวัน:"}),e.jsx("div",{className:"font-bold",children:g(b(o))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"รายสัปดาห์:"}),e.jsx("div",{className:"font-bold",children:g(p(o))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"รายเดือน:"}),e.jsx("div",{className:"font-bold",children:g(C(o))})]})]})]})]}),e.jsx(_e,{children:e.jsx(O,{onClick:T,children:i!==null?"บันทึกการแก้ไข":"เพิ่มพนักงาน"})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"ต้นทุนรวม/เดือน"}),e.jsx("div",{className:"text-2xl font-bold",children:g(f())})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"แรงงานโดยตรง"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:g(w())})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"แรงงานทางอ้อม"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g(k())})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"จำนวนพนักงาน"}),e.jsxs("div",{className:"text-2xl font-bold",children:[s.length," คน"]})]})]}),e.jsxs(we,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(G,{value:"all",children:"ทั้งหมด"}),e.jsxs(G,{value:"direct",children:["แรงงานโดยตรง (",u.length,")"]}),e.jsxs(G,{value:"indirect",children:["แรงงานทางอ้อม (",c.length,")"]})]}),e.jsx(H,{value:"all",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"รายการพนักงานทั้งหมด"}),e.jsxs(I,{children:["ต้นทุนแรงงานรวม ",g(f())," ต่อเดือน"]})]}),e.jsx($,{children:e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"ตำแหน่งงาน"}),e.jsx(F,{children:"ประเภท"}),e.jsx(F,{className:"text-right",children:"ค่าจ้าง/ชม."}),e.jsx(F,{className:"text-right",children:"ชั่วโมง/วัน"}),e.jsx(F,{className:"text-right",children:"วัน/สัปดาห์"}),e.jsx(F,{className:"text-right",children:"รายวัน"}),e.jsx(F,{className:"text-right",children:"รายเดือน"}),e.jsx(F,{className:"text-right",children:"การดำเนินการ"})]})}),e.jsx(fe,{children:s.map((h,D)=>e.jsxs(Y,{children:[e.jsx(N,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"w-4 h-4"}),h.role]})}),e.jsx(N,{children:j(h.type)}),e.jsx(N,{className:"text-right",children:g(h.wagePerHour)}),e.jsx(N,{className:"text-right",children:h.hoursPerDay}),e.jsx(N,{className:"text-right",children:h.daysPerWeek}),e.jsx(N,{className:"text-right font-medium",children:g(b(h))}),e.jsx(N,{className:"text-right font-bold",children:g(C(h))}),e.jsx(N,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>E(D),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>S(D),children:e.jsx(ie,{className:"w-3 h-3"})})]})})]},h.id))})]})})]})}),e.jsx(H,{value:"direct",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"w-5 h-5 text-green-600"}),"แรงงานโดยตรง"]}),e.jsxs(I,{children:["พนักงานที่เกี่ยวข้องการผลิตโดยตรง - ต้นทุน ",g(w())," ต่อเดือน"]})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map((h,D)=>e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:h.role}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>E(s.indexOf(h)),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>S(s.indexOf(h)),children:e.jsx(ie,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:"w-3 h-3"}),g(h.wagePerHour),"/ชั่วโมง"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Cs,{className:"w-3 h-3"}),h.hoursPerDay," ชม./วัน × ",h.daysPerWeek," วัน/สัปดาห์"]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"ต้นทุน/เดือน:"}),e.jsx("span",{className:"font-bold text-green-600",children:g(C(h))})]})})]},h.id))})})]})}),e.jsx(H,{value:"indirect",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"w-5 h-5 text-blue-600"}),"แรงงานทางอ้อม"]}),e.jsxs(I,{children:["พนักงานบริหารและขาย - ต้นทุน ",g(k())," ต่อเดือน"]})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(h=>e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:h.role}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>E(s.indexOf(h)),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>S(s.indexOf(h)),children:e.jsx(ie,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:"w-3 h-3"}),g(h.wagePerHour),"/ชั่วโมง"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Cs,{className:"w-3 h-3"}),h.hoursPerDay," ชม./วัน × ",h.daysPerWeek," วัน/สัปดาห์"]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"ต้นทุน/เดือน:"}),e.jsx("span",{className:"font-bold text-blue-600",children:g(C(h))})]})})]},h.id))})})]})})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"การวิเคราะห์ประสิทธิภาพแรงงาน"}),e.jsx(I,{children:"ตัวชี้วัดประสิทธิภาพและต้นทุนแรงงาน"})]}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-green-900",children:"สัดส่วนแรงงานโดยตรง"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[f()>0?(w()/f()*100).toFixed(1):0,"%"]}),e.jsxs("div",{className:"text-xs text-green-700",children:[g(w())," จาก ",g(f())]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"สัดส่วนแรงงานทางอ้อม"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[f()>0?(k()/f()*100).toFixed(1):0,"%"]}),e.jsxs("div",{className:"text-xs text-blue-700",children:[g(k())," จาก ",g(f())]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"ค่าแรงเฉลี่ย/ชั่วโมง"}),e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:s.length>0?g(s.reduce((h,D)=>h+D.wagePerHour,0)/s.length):g(0)}),e.jsxs("div",{className:"text-xs text-gray-700",children:["เฉลี่ยทั้งหมด ",s.length," ตำแหน่ง"]})]})]})})]})]})}function On(){const{data:a}=de(),[s,t]=v.useState(()=>a?.fixedCosts||[]),[r,n]=v.useState(!1),[i,l]=v.useState(null),[o,d]=v.useState({id:"",name:"",amountPerMonth:0}),m=()=>{d({id:"",name:"",amountPerMonth:0})},b=()=>s.reduce((j,u)=>j+u.amountPerMonth,0),p=()=>b()*12,C=()=>{const j=o.id||`fixed_${Date.now()}`,u={...o,id:j},c=i!==null?s.map((h,D)=>D===i?u:h):[...s,u];t(c),financeEngine.updateFixedCosts(c),onUpdate(),m(),l(null),n(!1)},f=j=>{d(s[j]),l(j),n(!0)},w=j=>{const u=s.filter((c,h)=>h!==j);t(u),financeEngine.updateFixedCosts(u),onUpdate()},k=j=>{const u=j.toLowerCase();return u.includes("เช่า")||u.includes("rent")?e.jsx(Ls,{className:"w-4 h-4"}):u.includes("เน็ต")||u.includes("internet")?e.jsx(lr,{className:"w-4 h-4"}):u.includes("ซ่อม")||u.includes("maintenance")?e.jsx(cr,{className:"w-4 h-4"}):u.includes("เสื่อม")||u.includes("depreciation")?e.jsx(hs,{className:"w-4 h-4"}):e.jsx(Ae,{className:"w-4 h-4"})},T=j=>{const u=j.toLowerCase();return u.includes("เช่า")||u.includes("rent")?"เช่าและค่าธรรมเนียม":u.includes("เน็ต")||u.includes("internet")||u.includes("โทร")?"สื่อสาร":u.includes("ซ่อม")||u.includes("maintenance")?"ซ่อมบำรุง":u.includes("เสื่อม")||u.includes("depreciation")?"ค่าเสื่อมราคา":u.includes("ประกัน")||u.includes("insurance")?"ประกัน":u.includes("ใบอนุญาต")||u.includes("license")?"ใบอนุญาต":"อื่น ๆ"},E=s.reduce((j,u)=>{const c=T(u.name);return j[c]||(j[c]=[]),j[c].push(u),j},{}),S=[{name:"ค่าเช่าพื้นที่",amount:0,category:"เช่าและค่าธรรมเนียม"},{name:"ค่าอินเทอร์เน็ต",amount:700,category:"สื่อสาร"},{name:"ค่าโทรศัพท์",amount:300,category:"สื่อสาร"},{name:"ค่าซ่อมบำรุงขั้นต่ำ",amount:1e3,category:"ซ่อมบำรุง"},{name:"ค่าเสื่อมราคาอุปกรณ์",amount:1500,category:"ค่าเสื่อมราคา"},{name:"ประกันอุบัติเหตุ",amount:500,category:"ประกัน"},{name:"ใบอนุญาตประกอบการ",amount:200,category:"ใบอนุญาต"},{name:"ค่าสมาชิกธนาคาร",amount:50,category:"เช่าและค่าธรรมเนียม"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"ค่าใช้จ่ายคงที่"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการต้นทุนที่ไม่เปลี่ยนแปลงตามปริมาณการขาย"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"ต้นทุนรวม/เดือน"}),e.jsx("div",{className:"text-xl font-bold",children:g(b())})]}),e.jsxs(Ee,{open:r,onOpenChange:n,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(O,{onClick:()=>{m(),l(null)},children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"เพิ่มรายการ"]})}),e.jsxs(Te,{children:[e.jsxs(Oe,{children:[e.jsx(Fe,{children:i!==null?"แก้ไขค่าใช้จ่ายคงที่":"เพิ่มค่าใช้จ่ายคงที่"}),e.jsx(Ye,{children:"กรอกรายการค่าใช้จ่ายที่เกิดขึ้นประจำทุกเดือน"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"cost-name",children:"รายการ"}),e.jsx(B,{id:"cost-name",value:o.name,onChange:j=>d(u=>({...u,name:j.target.value})),placeholder:"ค่าเช่า, ค่าไฟฟ้าพื้นฐาน, ค่าประกัน"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"amount",children:"จำนวนเงิน/เดือน (บาท)"}),e.jsx(B,{id:"amount",type:"number",value:o.amountPerMonth,onChange:j=>d(u=>({...u,amountPerMonth:Ke(j.target.value)})),placeholder:"1000"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-sm font-medium",children:["ประเภท: ",T(o.name)]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["ต้นทุนต่อปี: ",g(o.amountPerMonth*12)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"เพิ่มรายการแนะนำ:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:S.map((j,u)=>e.jsx(O,{variant:"outline",size:"sm",onClick:()=>d(c=>({...c,name:j.name,amountPerMonth:j.amount})),children:j.name},u))})]})]}),e.jsx(_e,{children:e.jsx(O,{onClick:C,children:i!==null?"บันทึกการแก้ไข":"เพิ่มรายการ"})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"ต้นทุนรวม/เดือน"}),e.jsx("div",{className:"text-2xl font-bold",children:g(b())})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"ต้นทุนรวม/ปี"}),e.jsx("div",{className:"text-2xl font-bold",children:g(p())})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"จำนวนรายการ"}),e.jsxs("div",{className:"text-2xl font-bold",children:[s.length," รายการ"]})]}),e.jsxs(P,{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"เฉลี่ย/รายการ"}),e.jsx("div",{className:"text-2xl font-bold",children:s.length>0?g(b()/s.length):g(0)})]})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"รายการค่าใช้จ่ายคงที่"}),e.jsx(I,{children:"ค่าใช้จ่ายที่เกิดขึ้นประจำทุกเดือนโดยไม่ขึ้นกับปริมาณการขาย"})]}),e.jsx($,{children:e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"รายการ"}),e.jsx(F,{children:"ประเภท"}),e.jsx(F,{className:"text-right",children:"จำนวน/เดือน"}),e.jsx(F,{className:"text-right",children:"จำนวน/ปี"}),e.jsx(F,{className:"text-right",children:"สัดส่วน"}),e.jsx(F,{className:"text-right",children:"การดำเนินการ"})]})}),e.jsx(fe,{children:s.map((j,u)=>e.jsxs(Y,{children:[e.jsx(N,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[k(j.name),j.name]})}),e.jsx(N,{children:e.jsx(q,{variant:"outline",children:T(j.name)})}),e.jsx(N,{className:"text-right font-medium",children:g(j.amountPerMonth)}),e.jsx(N,{className:"text-right",children:g(j.amountPerMonth*12)}),e.jsx(N,{className:"text-right",children:b()>0?`${(j.amountPerMonth/b()*100).toFixed(1)}%`:"0%"}),e.jsx(N,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>f(u),children:e.jsx(oe,{className:"w-3 h-3"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>w(u),children:e.jsx(ie,{className:"w-3 h-3"})})]})})]},j.id))})]})})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"สรุปตามประเภท"}),e.jsx(I,{children:"แสดงค่าใช้จ่ายคงที่จัดกลุ่มตามประเภท"})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(E).map(([j,u])=>{const c=u.reduce((D,x)=>D+x.amountPerMonth,0),h=b()>0?c/b()*100:0;return e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:j}),e.jsxs(q,{variant:"secondary",children:[u.length," รายการ"]})]}),e.jsx("div",{className:"space-y-1 text-sm text-muted-foreground mb-3",children:u.map(D=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:D.name}),e.jsx("span",{children:g(D.amountPerMonth)})]},D.id))}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"รวม/เดือน:"}),e.jsx("span",{className:"font-bold",children:g(c)})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"สัดส่วน:"}),e.jsxs("span",{children:[h.toFixed(1),"%"]})]})]})]},j)})})})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"การวิเคราะห์ค่าใช้จ่ายคงที่"}),e.jsx(I,{children:"ตัวชี้วัดและข้อเสนอแนะ"})]}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"ต้นทุนคงที่/วัน"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g(b()/30)}),e.jsx("div",{className:"text-xs text-blue-700",children:"จำนวนเงินที่ต้องชดเชยทุกวัน"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-green-900",children:"Break-Even ประมาณ"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(b()/30/40)," จาน/วัน"]}),e.jsx("div",{className:"text-xs text-green-700",children:"สมมติ CM เฉลี่ย 40 บาท/จาน"})]}),e.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-orange-900",children:"รายการสูงสุด"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.length>0?g(Math.max(...s.map(j=>j.amountPerMonth))):g(0)}),e.jsx("div",{className:"text-xs text-orange-700",children:s.length>0?s.find(j=>j.amountPerMonth===Math.max(...s.map(u=>u.amountPerMonth)))?.name:"ไม่มีข้อมูล"})]})]})})]})]})}function _n({currentScenario:a,onScenarioChange:s}){const[t]=v.useState(()=>({})),[r,n]=v.useState(!1),[i,l]=v.useState(""),[o,d]=v.useState(["base","S1"]),[m,b]=v.useState(0),[p,C]=v.useState(0),[f,w]=v.useState(0),[k,T]=v.useState(0),[E,S]=v.useState(0),j=[{name:"ขึ้นราคา 5%",deltas:{menuPriceDeltaPercent:5}},{name:"วัตถุดิบ +10%",deltas:{ingredientCostDeltaPercent:10}},{name:"ค่าไฟ +15%",deltas:{electricRateDeltaPercent:15}},{name:"ลด Waste 50%",deltas:{wasteDeltaPercent:-50}},{name:"เพิ่มประสิทธิภาพ 20%",deltas:{laborProductivityDeltaPercent:20}}],u=()=>{n(!1),l("")},c=()=>{onUpdate()},h=y=>({revenue:18e4+(y==="S1"?9e3:0),profit:6e4+(y==="S1"?5e3:0),primeCostPct:58+(y==="S1"?-2:0),bepUnits:2500+(y==="S1"?-200:0)}),D=o.map(y=>{const W=h(y);return{scenario:y==="base"?"ฐาน":y,revenue:W.revenue,profit:W.profit,primeCost:W.primeCostPct,bep:W.bepUnits}}),x=[{variable:"ราคาเมนู",change:-10,impact:-15.2},{variable:"ราคาเมนู",change:-5,impact:-7.6},{variable:"ราคาเมนู",change:0,impact:0},{variable:"ราคาเมนู",change:5,impact:8.3},{variable:"ราคาเมนู",change:10,impact:16.7}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"สถานการณ์และการเปรียบเทียบ"}),e.jsx("p",{className:"text-muted-foreground",children:"สร้างและเปรียบเทียบสถานการณ์ทางการเงินที่แตกต่างกัน"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(q,{variant:"outline",children:["สถานการณ์ปัจจุบัน: ",a==="base"?"ฐาน":a]}),e.jsxs(Ee,{open:r,onOpenChange:n,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(O,{children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"สร้างสถานการณ์"]})}),e.jsxs(Te,{children:[e.jsxs(Oe,{children:[e.jsx(Fe,{children:"สร้างสถานการณ์ใหม่"}),e.jsx(Ye,{children:"สร้างสถานการณ์ใหม่เพื่อทดสอบการเปลี่ยนแปลงต่าง ๆ"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"scenario-name",children:"ชื่อสถานการณ์"}),e.jsx(B,{id:"scenario-name",value:i,onChange:y=>l(y.target.value),placeholder:"เช่น: ขึ้นราคา 5%, ลดต้นทุน 10%"})]})}),e.jsx(_e,{children:e.jsx(O,{onClick:u,children:"สร้าง"})})]})]})]})]}),e.jsxs(we,{defaultValue:"adjust",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(G,{value:"adjust",children:"ปรับตัวแปร"}),e.jsx(G,{value:"compare",children:"เปรียบเทียบ"}),e.jsx(G,{value:"sensitivity",children:"ความไว"}),e.jsx(G,{value:"quick",children:"Quick Scenarios"})]}),e.jsx(H,{value:"adjust",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"ปรับตัวแปรสถานการณ์"}),e.jsx(I,{children:"ใช้ Slider เพื่อปรับเปลี่ยนตัวแปรต่าง ๆ และดูผลกระทบทันที"})]}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(R,{children:"ราคาเมนู"}),e.jsxs(q,{variant:m>0?"default":m<0?"destructive":"secondary",children:[m>=0?"+":"",m,"%"]})]}),e.jsx(ye,{value:[m],onValueChange:y=>b(y[0]),max:30,min:-20,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"-20%"}),e.jsx("span",{children:"+30%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(R,{children:"ต้นทุนวัตถุดิบ"}),e.jsxs(q,{variant:p>0?"destructive":p<0?"default":"secondary",children:[p>=0?"+":"",p,"%"]})]}),e.jsx(ye,{value:[p],onValueChange:y=>C(y[0]),max:50,min:-30,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"-30%"}),e.jsx("span",{children:"+50%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(R,{children:"ค่าไฟฟ้า"}),e.jsxs(q,{variant:f>0?"destructive":f<0?"default":"secondary",children:[f>=0?"+":"",f,"%"]})]}),e.jsx(ye,{value:[f],onValueChange:y=>w(y[0]),max:40,min:-20,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"-20%"}),e.jsx("span",{children:"+40%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(R,{children:"ประสิทธิภาพแรงงาน"}),e.jsxs(q,{variant:k>0?"default":k<0?"destructive":"secondary",children:[k>=0?"+":"",k,"%"]})]}),e.jsx(ye,{value:[k],onValueChange:y=>T(y[0]),max:50,min:-30,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"-30%"}),e.jsx("span",{children:"+50%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(R,{children:"การเสียหาย/Waste"}),e.jsxs(q,{variant:E<0?"default":E>0?"destructive":"secondary",children:[E>=0?"+":"",E,"%"]})]}),e.jsx(ye,{value:[E],onValueChange:y=>S(y[0]),max:30,min:-70,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"-70%"}),e.jsx("span",{children:"+30%"})]})]}),e.jsxs(O,{onClick:c,className:"w-full",children:[e.jsx(or,{className:"w-4 h-4 mr-2"}),"ใช้การเปลี่ยนแปลง"]})]})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"ผลกระทบจากการเปลี่ยนแปลง"}),e.jsx(I,{children:"ดูผลกระทบต่อ KPI สำคัญ"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"รายได้/เดือน"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:g(18e4*(1+m/100))}),e.jsxs("div",{className:"text-xs text-blue-700",children:[m>=0?"+":"",g(18e4*m/100)]})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-green-900",children:"กำไรขั้นต้น"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:g(6e4+18e4*m/100-4e4*p/100)}),e.jsxs("div",{className:"text-xs text-green-700",children:["เปลี่ยนแปลง ",((m-p*.22)*3).toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-orange-900",children:"Prime Cost %"}),e.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[(58+p*.2-m*.3).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-orange-700",children:"ฐาน: 58.0%"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-purple-900",children:"BEP Units/เดือน"}),e.jsx("div",{className:"text-lg font-bold text-purple-600",children:Math.round(2500-m*50+p*30)}),e.jsx("div",{className:"text-xs text-purple-700",children:"ฐาน: 2,500 จาน"})]})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"สรุปผลกระทบ"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[m>0&&e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx(Ne,{className:"w-3 h-3"}),"ขึ้นราคา ",m,"% จะเพิ่มรายได้ ",g(18e4*m/100)]}),p>0&&e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(hs,{className:"w-3 h-3"}),"ต้นทุนวัตถุดิบเพิ่ม ",p,"% จะลดกำไร ",g(4e4*p/100)]}),f>0&&e.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[e.jsx(hs,{className:"w-3 h-3"}),"ค่าไฟเพิ่ม ",f,"% จะเพิ่มต้นทุน ",g(5e3*f/100),"/เดือน"]})]})]})]})]})]})}),e.jsx(H,{value:"compare",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"เปรียบเทียบสถานการณ์"}),e.jsx(I,{children:"เลือกสถานการณ์เพื่อเปรียบเทียบผลลัพธ์ทางการเงิน"})]}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"เมตริก"}),e.jsx(F,{className:"text-right",children:"ฐาน"}),e.jsx(F,{className:"text-right",children:"S1"}),e.jsx(F,{className:"text-right",children:"เปลี่ยนแปลง"})]})}),e.jsxs(fe,{children:[e.jsxs(Y,{children:[e.jsx(N,{children:"รายได้/เดือน"}),e.jsx(N,{className:"text-right",children:g(18e4)}),e.jsx(N,{className:"text-right",children:g(189e3)}),e.jsxs(N,{className:"text-right text-green-600",children:["+",g(9e3)]})]}),e.jsxs(Y,{children:[e.jsx(N,{children:"กำไรขั้นต้น"}),e.jsx(N,{className:"text-right",children:g(6e4)}),e.jsx(N,{className:"text-right",children:g(65e3)}),e.jsxs(N,{className:"text-right text-green-600",children:["+",g(5e3)]})]}),e.jsxs(Y,{children:[e.jsx(N,{children:"Prime Cost %"}),e.jsx(N,{className:"text-right",children:"58.0%"}),e.jsx(N,{className:"text-right",children:"56.0%"}),e.jsx(N,{className:"text-right text-green-600",children:"-2.0%"})]}),e.jsxs(Y,{children:[e.jsx(N,{children:"BEP Units"}),e.jsx(N,{className:"text-right",children:"2,500"}),e.jsx(N,{className:"text-right",children:"2,300"}),e.jsx(N,{className:"text-right text-green-600",children:"-200"})]})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-4",children:"เปรียบเทียบรายได้และกำไร"}),e.jsx(os,{width:"100%",height:300,children:e.jsxs(Za,{data:D,children:[e.jsx(ys,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"scenario"}),e.jsx(Ns,{tickFormatter:y=>g(y)}),e.jsx(ds,{formatter:y=>g(y)}),e.jsx(qs,{dataKey:"revenue",fill:"#8884d8",name:"รายได้"}),e.jsx(qs,{dataKey:"profit",fill:"#82ca9d",name:"กำไร"})]})})]})]})})]})}),e.jsx(H,{value:"sensitivity",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"การวิเคราะห์ความไว (Sensitivity Analysis)"}),e.jsx(I,{children:"ดูผลกระทบของการเปลี่ยนแปลงตัวแปรหนึ่งต่อกำไร"})]}),e.jsx($,{children:e.jsx(os,{width:"100%",height:400,children:e.jsxs(_t,{data:x,children:[e.jsx(ys,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"change",tickFormatter:y=>`${y}%`}),e.jsx(Ns,{tickFormatter:y=>`${y}%`}),e.jsx(ds,{formatter:y=>[`${y}%`,"ผลกระทบต่อกำไร"],labelFormatter:y=>`การเปลี่ยนแปลง: ${y}%`}),e.jsx(ws,{type:"monotone",dataKey:"impact",stroke:"#8884d8",strokeWidth:3,dot:{fill:"#8884d8",strokeWidth:2,r:4}})]})})})]})}),e.jsx(H,{value:"quick",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"Quick Scenarios"}),e.jsx(I,{children:"ใช้สถานการณ์ที่เตรียมไว้เพื่อการทดสอบเร็ว"})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map((y,W)=>e.jsxs(P,{className:"p-4 cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:y.name}),e.jsxs(O,{size:"sm",variant:"outline",children:[e.jsx(dr,{className:"w-3 h-3 mr-1"}),"ใช้"]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.entries(y.deltas).map(([K,X])=>e.jsxs("div",{children:[K.includes("Price")&&"ราคา",K.includes("Cost")&&"ต้นทุน",K.includes("Rate")&&"อัตรา",K.includes("Waste")&&"การเสียหาย",K.includes("Productivity")&&"ประสิทธิภาพ",": ",X>=0?"+":"",X,"%"]},K))})]},W))})})]})})]})]})}function Fn({financialData:a}){de();const[s,t]=v.useState("monthly");if(!a)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ss,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{children:"กำลังโหลดข้อมูลรายงาน..."})]})});const{kpis:r,pnl:n,menus:i}=a,l=()=>{const f=financeEngine.exportJSON();en(JSON.parse(f),`finance-data-${new Date().toISOString().split("T")[0]}.json`)},o=()=>{const f=[{period:"รายวัน",revenue:n.daily.revenue,cogs:n.daily.cogs,grossProfit:n.daily.grossProfit,operatingExpenses:n.daily.operatingExpenses,operatingProfit:n.daily.operatingProfit},{period:"รายเดือน",revenue:n.monthly.revenue,cogs:n.monthly.cogs,grossProfit:n.monthly.grossProfit,operatingExpenses:n.monthly.operatingExpenses,operatingProfit:n.monthly.operatingProfit}];dt(f,`pnl-${new Date().toISOString().split("T")[0]}.csv`)},d=()=>{const f=i.map(w=>({menuName:w.name,price:w.price,variableCost:w.vc,contributionMargin:w.cm,contributionMarginPercent:w.cmPct}));dt(f,`menu-analysis-${new Date().toISOString().split("T")[0]}.csv`)},m=()=>{window.print()},b={grossMargin:n.daily.grossProfit/n.daily.revenue*100,operatingMargin:n.daily.operatingProfit/n.daily.revenue*100,contributionMargin:r.cmPct},p=[{category:"ต้นทุนขาย (COGS)",amount:n.daily.cogs,percentage:n.daily.cogs/n.daily.revenue*100},{category:"ค่าใช้จ่ายดำเนินงาน",amount:n.daily.operatingExpenses,percentage:n.daily.operatingExpenses/n.daily.revenue*100}],C=[{metric:"รายได้รายวัน",value:g(r.revenue),status:"good"},{metric:"กำไรขั้นต้น",value:g(r.grossProfit),status:"good"},{metric:"กำไรจากการดำเนินงาน",value:g(r.operatingProfit),status:r.operatingProfit>0?"good":"warning"},{metric:"Prime Cost %",value:J(r.primeCostPct),status:r.primeCostPct<60?"good":"warning"},{metric:"Food Cost %",value:J(r.foodCostPct),status:r.foodCostPct<35?"good":"warning"},{metric:"Labor %",value:J(r.laborPct),status:r.laborPct<25?"good":"warning"},{metric:"จุดคุ้มทุน/วัน",value:`${Math.round(r.bepPerDay)} จาน`,status:r.bepPerDay<100?"good":"warning"},{metric:"Safety Margin",value:J(r.safetyMargin),status:r.safetyMargin>30?"good":"warning"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"รายงานการเงิน"}),e.jsx("p",{className:"text-muted-foreground",children:"สรุปผลการดำเนินงานและการส่งออกข้อมูล"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(O,{variant:"outline",onClick:m,children:[e.jsx(Qs,{className:"w-4 h-4 mr-2"}),"พิมพ์"]}),e.jsxs(O,{variant:"outline",onClick:l,children:[e.jsx(ss,{className:"w-4 h-4 mr-2"}),"Export JSON"]})]})]}),e.jsxs(we,{defaultValue:"summary",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(G,{value:"summary",children:"สรุปผลการดำเนินงาน"}),e.jsx(G,{value:"pnl",children:"งบกำไรขาดทุน"}),e.jsx(G,{value:"menu",children:"วิเคราะห์เมนู"}),e.jsx(G,{value:"export",children:"ส่งออกข้อมูล"})]}),e.jsxs(H,{value:"summary",className:"space-y-6",children:[e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"สรุปผู้บริหาร"]}),e.jsxs(I,{children:["ตัวชี้วัดสำคัญและผลการดำเนินงาน ณ วันที่ ",new Date().toLocaleDateString("th-TH")]})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:C.map((f,w)=>e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:f.metric}),e.jsx("div",{className:"text-lg font-bold mt-1",children:f.value}),e.jsx(q,{variant:f.status==="good"?"default":"secondary",className:"text-xs mt-1",children:f.status==="good"?"ดี":"ต้องปรับปรุง"})]},w))})})]}),e.jsxs(P,{children:[e.jsx(z,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"วิเคราะห์ความสามารถในการทำกำไร"]})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-green-900",children:"Gross Profit Margin"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:J(b.grossMargin)}),e.jsx("div",{className:"text-xs text-green-700",children:"อุตสาหกรรมเฉลี่ย: 65-75%"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"Operating Profit Margin"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:J(b.operatingMargin)}),e.jsxs("div",{className:"text-xs text-blue-700",children:["เป้าหมาย: ",">"," 15%"]})]}),e.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-orange-900",children:"Contribution Margin"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:J(b.contributionMargin)}),e.jsxs("div",{className:"text-xs text-orange-700",children:["เป้าหมาย: ",">"," 60%"]})]})]})})]}),e.jsxs(P,{children:[e.jsx(z,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Zs,{className:"w-5 h-5"}),"โครงสร้างต้นทุน"]})}),e.jsx($,{children:e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"หมวดหมู่"}),e.jsx(F,{className:"text-right",children:"จำนวน (รายวัน)"}),e.jsx(F,{className:"text-right",children:"ร้อยละของรายได้"}),e.jsx(F,{className:"text-right",children:"สถานะ"})]})}),e.jsx(fe,{children:p.map((f,w)=>e.jsxs(Y,{children:[e.jsx(N,{className:"font-medium",children:f.category}),e.jsx(N,{className:"text-right",children:g(f.amount)}),e.jsx(N,{className:"text-right",children:J(f.percentage)}),e.jsx(N,{className:"text-right",children:e.jsx(q,{variant:f.percentage<50?"default":"secondary",children:f.percentage<50?"เหมาะสม":"ต้องตรวจสอบ"})})]},w))})]})})]})]}),e.jsx(H,{value:"pnl",className:"space-y-4",children:e.jsxs(P,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(L,{children:"งบกำไรขาดทุน (P&L Statement)"}),e.jsx(I,{children:"แสดงผลการดำเนินงานทางการเงินรายวันและรายเดือน"})]}),e.jsxs(O,{onClick:o,children:[e.jsx(ss,{className:"w-4 h-4 mr-2"}),"Export P&L"]})]})}),e.jsx($,{children:e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"รายการ"}),e.jsx(F,{className:"text-right",children:"รายวัน"}),e.jsx(F,{className:"text-right",children:"รายเดือน"}),e.jsx(F,{className:"text-right",children:"% ของรายได้"})]})}),e.jsxs(fe,{children:[e.jsxs(Y,{className:"font-medium",children:[e.jsx(N,{children:"รายได้"}),e.jsx(N,{className:"text-right",children:g(n.daily.revenue)}),e.jsx(N,{className:"text-right",children:g(n.monthly.revenue)}),e.jsx(N,{className:"text-right",children:"100.0%"})]}),e.jsxs(Y,{children:[e.jsx(N,{className:"pl-4",children:"ต้นทุนขาย (COGS)"}),e.jsxs(N,{className:"text-right",children:["(",g(n.daily.cogs),")"]}),e.jsxs(N,{className:"text-right",children:["(",g(n.monthly.cogs),")"]}),e.jsxs(N,{className:"text-right",children:["(",J(n.daily.cogs/n.daily.revenue*100),")"]})]}),e.jsxs(Y,{className:"font-medium border-t",children:[e.jsx(N,{children:"กำไรขั้นต้น"}),e.jsx(N,{className:"text-right",children:g(n.daily.grossProfit)}),e.jsx(N,{className:"text-right",children:g(n.monthly.grossProfit)}),e.jsx(N,{className:"text-right",children:J(n.daily.grossProfit/n.daily.revenue*100)})]}),e.jsxs(Y,{children:[e.jsx(N,{className:"pl-4",children:"ค่าใช้จ่ายดำเนินงาน"}),e.jsxs(N,{className:"text-right",children:["(",g(n.daily.operatingExpenses),")"]}),e.jsxs(N,{className:"text-right",children:["(",g(n.monthly.operatingExpenses),")"]}),e.jsxs(N,{className:"text-right",children:["(",J(n.daily.operatingExpenses/n.daily.revenue*100),")"]})]}),e.jsxs(Y,{className:"font-bold border-t",children:[e.jsx(N,{children:"กำไรจากการดำเนินงาน"}),e.jsx(N,{className:"text-right",children:g(n.daily.operatingProfit)}),e.jsx(N,{className:"text-right",children:g(n.monthly.operatingProfit)}),e.jsx(N,{className:"text-right",children:J(n.daily.operatingProfit/n.daily.revenue*100)})]})]})]})})]})}),e.jsx(H,{value:"menu",className:"space-y-4",children:e.jsxs(P,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(L,{children:"วิเคราะห์ผลตอบแทนรายเมนู"}),e.jsx(I,{children:"Unit Economics และ Contribution Margin ของแต่ละรายการอาหาร"})]}),e.jsxs(O,{onClick:d,children:[e.jsx(ss,{className:"w-4 h-4 mr-2"}),"Export Menu Analysis"]})]})}),e.jsxs($,{children:[e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(Y,{children:[e.jsx(F,{children:"เมนู"}),e.jsx(F,{className:"text-right",children:"ราคาขาย"}),e.jsx(F,{className:"text-right",children:"ต้นทุนผันแปร"}),e.jsx(F,{className:"text-right",children:"Contribution Margin"}),e.jsx(F,{className:"text-right",children:"CM %"}),e.jsx(F,{className:"text-right",children:"การประเมิน"})]})}),e.jsx(fe,{children:i.map((f,w)=>e.jsxs(Y,{children:[e.jsx(N,{className:"font-medium",children:f.name}),e.jsx(N,{className:"text-right",children:g(f.price)}),e.jsx(N,{className:"text-right",children:g(f.vc)}),e.jsx(N,{className:"text-right",children:g(f.cm)}),e.jsx(N,{className:"text-right",children:e.jsx(q,{variant:f.cmPct>60?"default":f.cmPct>40?"secondary":"destructive",children:J(f.cmPct)})}),e.jsx(N,{className:"text-right",children:f.cmPct>60?"⭐ ดีเยี่ยม":f.cmPct>40?"✅ ปานกลาง":"⚠️ ต้องปรับปรุง"})]},w))})]}),e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"ข้อเสนะแนะการปรับปรุงเมนู"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[i.some(f=>f.cmPct<40)&&e.jsx("div",{className:"text-orange-700",children:"• เมนูที่มี CM % ต่ำกว่า 40% ควรทบทวนราคาขายหรือลดต้นทุนวัตถุดิบ"}),i.some(f=>f.cmPct>70)&&e.jsx("div",{className:"text-green-700",children:"• เมนูที่มี CM % สูงกว่า 70% สามารถใช้เป็นจุดแข็งในการขาย"}),e.jsx("div",{className:"text-blue-700",children:"• เป้าหมาย CM % เฉลี่ย: 60-65% สำหรับร้านอาหารประเภทนี้"})]})]})]})]})}),e.jsx(H,{value:"export",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-5 h-5"}),"ส่งออกข้อมูล"]}),e.jsx(I,{children:"ดาวน์โหลดข้อมูลในรูปแบบต่าง ๆ"})]}),e.jsxs($,{className:"space-y-3",children:[e.jsxs(O,{onClick:l,className:"w-full justify-start",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"ข้อมูลทั้งหมด (JSON)",e.jsx(q,{variant:"secondary",className:"ml-auto",children:"สำรองข้อมูล"})]}),e.jsxs(O,{onClick:o,variant:"outline",className:"w-full justify-start",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"งบกำไรขาดทุน (CSV)",e.jsx(q,{variant:"outline",className:"ml-auto",children:"รายงาน"})]}),e.jsxs(O,{onClick:d,variant:"outline",className:"w-full justify-start",children:[e.jsx(Zs,{className:"w-4 h-4 mr-2"}),"วิเคราะห์เมนู (CSV)",e.jsx(q,{variant:"outline",className:"ml-auto",children:"รายงาน"})]}),e.jsxs(O,{onClick:m,variant:"outline",className:"w-full justify-start",children:[e.jsx(Qs,{className:"w-4 h-4 mr-2"}),"พิมพ์รายงาน (PDF)",e.jsx(q,{variant:"outline",className:"ml-auto",children:"A4"})]})]})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(hr,{className:"w-5 h-5"}),"การแชร์และนำเข้า"]}),e.jsx(I,{children:"แชร์รายงานหรือนำเข้าข้อมูลจากแหล่งอื่น"})]}),e.jsxs($,{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"นำเข้าข้อมูล"}),e.jsx("div",{className:"text-xs text-blue-700 mt-1",children:"ใช้ไฟล์ JSON ที่ส่งออกไว้ก่อนหน้านี้"}),e.jsx("input",{type:"file",accept:".json",className:"mt-2 text-xs",onChange:f=>{const w=f.target.files?.[0];if(w){const k=new FileReader;k.onload=T=>{try{const E=T.target?.result;financeEngine.importJSON(E),alert("นำเข้าข้อมูลสำเร็จ")}catch{alert("เกิดข้อผิดพลาดในการนำเข้าข้อมูล")}},k.readAsText(w)}}})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-green-900",children:"แชร์รายงาน"}),e.jsx("div",{className:"text-xs text-green-700 mt-1",children:"ส่งรายงานให้นักบัญ��ีหรือที่ปรึกษา"}),e.jsx(O,{size:"sm",variant:"outline",className:"mt-2",children:"คัดลอกลิงก์"})]}),e.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-orange-900",children:"ข้อมูลส่วนตัว"}),e.jsx("div",{className:"text-xs text-orange-700 mt-1",children:"ข้อมูลถูกเก็บในเครื่องของคุณเท่านั้น"})]})]})]})]})})]})]})}var xs="Switch",[Un]=Fs(xs),[zn,Ln]=Un(xs),oa=v.forwardRef((a,s)=>{const{__scopeSwitch:t,name:r,checked:n,defaultChecked:i,required:l,disabled:o,value:d="on",onCheckedChange:m,form:b,...p}=a,[C,f]=v.useState(null),w=le(s,j=>f(j)),k=v.useRef(!1),T=C?b||!!C.closest("form"):!0,[E,S]=wt({prop:n,defaultProp:i??!1,onChange:m,caller:xs});return e.jsxs(zn,{scope:t,checked:E,disabled:o,children:[e.jsx(je.button,{type:"button",role:"switch","aria-checked":E,"aria-required":l,"data-state":xa(E),"data-disabled":o?"":void 0,disabled:o,value:d,...p,ref:w,onClick:ue(a.onClick,j=>{S(u=>!u),T&&(k.current=j.isPropagationStopped(),k.current||j.stopPropagation())})}),T&&e.jsx(ma,{control:C,bubbles:!k.current,name:r,value:d,checked:E,required:l,disabled:o,form:b,style:{transform:"translateX(-100%)"}})]})});oa.displayName=xs;var da="SwitchThumb",ha=v.forwardRef((a,s)=>{const{__scopeSwitch:t,...r}=a,n=Ln(da,t);return e.jsx(je.span,{"data-state":xa(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:s})});ha.displayName=da;var $n="SwitchBubbleInput",ma=v.forwardRef(({__scopeSwitch:a,control:s,checked:t,bubbles:r=!0,...n},i)=>{const l=v.useRef(null),o=le(l,i),d=St(t),m=Ct(s);return v.useEffect(()=>{const b=l.current;if(!b)return;const p=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(p,"checked").set;if(d!==t&&f){const w=new Event("click",{bubbles:r});f.call(b,t),b.dispatchEvent(w)}},[d,t,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...n,tabIndex:-1,ref:o,style:{...n.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ma.displayName=$n;function xa(a){return a?"checked":"unchecked"}var Vn=oa,In=ha;function Ie({className:a,...s}){return e.jsx(Vn,{"data-slot":"switch",className:U("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...s,children:e.jsx(In,{"data-slot":"switch-thumb",className:U("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var ua="AlertDialog",[Bn]=Fs(ua,[Ot]),he=Ot(),pa=a=>{const{__scopeAlertDialog:s,...t}=a,r=he(s);return e.jsx(kt,{...r,...t,modal:!0})};pa.displayName=ua;var Kn="AlertDialogTrigger",ga=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,n=he(t);return e.jsx(Dt,{...n,...r,ref:s})});ga.displayName=Kn;var Gn="AlertDialogPortal",fa=a=>{const{__scopeAlertDialog:s,...t}=a,r=he(s);return e.jsx(Rt,{...r,...t})};fa.displayName=Gn;var Hn="AlertDialogOverlay",ja=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,n=he(t);return e.jsx(Tt,{...n,...r,ref:s})});ja.displayName=Hn;var De="AlertDialogContent",[Wn,qn]=Bn(De),Jn=qa("AlertDialogContent"),va=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,children:r,...n}=a,i=he(t),l=v.useRef(null),o=le(s,l),d=v.useRef(null);return e.jsx(Wa,{contentName:De,titleName:ya,docsSlug:"alert-dialog",children:e.jsx(Wn,{scope:t,cancelRef:d,children:e.jsxs(Mt,{role:"alertdialog",...i,...n,ref:o,onOpenAutoFocus:ue(n.onOpenAutoFocus,m=>{m.preventDefault(),d.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(Jn,{children:r}),e.jsx(Xn,{contentRef:l})]})})})});va.displayName=De;var ya="AlertDialogTitle",ba=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,n=he(t);return e.jsx(At,{...n,...r,ref:s})});ba.displayName=ya;var Na="AlertDialogDescription",wa=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,n=he(t);return e.jsx(Et,{...n,...r,ref:s})});wa.displayName=Na;var Yn="AlertDialogAction",Pa=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,n=he(t);return e.jsx(Us,{...n,...r,ref:s})});Pa.displayName=Yn;var Ca="AlertDialogCancel",Sa=v.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,{cancelRef:n}=qn(Ca,t),i=he(t),l=le(s,n);return e.jsx(Us,{...i,...r,ref:l})});Sa.displayName=Ca;var Xn=({contentRef:a})=>{const s=`\`${De}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${De}\` by passing a \`${Na}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${De}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return v.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(s)},[s,a]),null},Qn=pa,Zn=ga,ei=fa,si=ja,ti=va,ai=Pa,ri=Sa,ni=ba,ii=wa;function mt({...a}){return e.jsx(Qn,{"data-slot":"alert-dialog",...a})}function xt({...a}){return e.jsx(Zn,{"data-slot":"alert-dialog-trigger",...a})}function li({...a}){return e.jsx(ei,{"data-slot":"alert-dialog-portal",...a})}function ci({className:a,...s}){return e.jsx(si,{"data-slot":"alert-dialog-overlay",className:U("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...s})}function ut({className:a,...s}){return e.jsxs(li,{children:[e.jsx(ci,{}),e.jsx(ti,{"data-slot":"alert-dialog-content",className:U("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...s})]})}function pt({className:a,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:U("flex flex-col gap-2 text-center sm:text-left",a),...s})}function gt({className:a,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:U("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...s})}function ft({className:a,...s}){return e.jsx(ni,{"data-slot":"alert-dialog-title",className:U("text-lg font-semibold",a),...s})}function jt({className:a,...s}){return e.jsx(ii,{"data-slot":"alert-dialog-description",className:U("text-muted-foreground text-sm",a),...s})}function vt({className:a,...s}){return e.jsx(ai,{className:U(Is(),a),...s})}function yt({className:a,...s}){return e.jsx(ri,{className:U(Is({variant:"outline"}),a),...s})}function oi(){const{data:a,reset:s,exportData:t,importData:r}=de(),[n,i]=v.useState(()=>a?.meta||{}),[l,o]=v.useState("th"),[d,m]=v.useState("THB"),[b,p]=v.useState(7),[C,f]=v.useState(!0);v.useEffect(()=>{a?.meta&&(i(a.meta),m(a.meta.currency||"THB"),p(a.meta.vatPercent||7))},[a]);const w=()=>{const u={...n,currency:d,vatPercent:b,language:l};i(u),alert("บันทึกการตั้งค่าเรียบร้อย")},k=()=>{localStorage.clear(),alert("ข้อมูลทั้งหมดถูกลบแล้ว กรุณาโหลดหน้าใหม่"),window.location.reload()},T=()=>{s(),alert("รีเซ็ตการตั้งค่าเรียบร้อย")},E=()=>{try{const u=t(),c=new Blob([u],{type:"application/json"}),h=URL.createObjectURL(c),D=document.createElement("a");D.href=h,D.download=`finance-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(h),alert("ส่งออกข้อมูลเรียบร้อย")}catch{alert("เกิดข้อผิดพลาดในการส่งออกข้อมูล")}},S=u=>{const c=u.target.files?.[0];if(!c)return;const h=new FileReader;h.onload=D=>{try{const x=r(D.target?.result);x.success?alert("นำเข้าข้อมูลเรียบร้อย"):alert(`เกิดข้อผิดพลาด: ${x.error}`)}catch{alert("เกิดข้อผิดพลาดในการนำเข้าข้อมูล")}},h.readAsText(c)},j=[{name:"ค่าไฟฟ้าต่อหน่วย",value:"5.00 บาท/kWh",description:"อัตราเฉลี่ยสำหรับธุรกิจขนาดเล็ก"},{name:"ค่าแก๊ส LPG",value:"29.33 บาท/กก.",description:"ราคาถังแก๊ส 15 กก. ประมาณ 440 บาท"},{name:"ค่าน้ำประปา",value:"14.00 บาท/ลบ.ม.",description:"อัตราเฉลี่ยกรุงเทพและปริมณฑล"},{name:"ค่าจ้างขั้นต่ำ",value:"354 บาท/วัน",description:"ปี 2024 (อ้างอิงเท่านั้น)"},{name:"Prime Cost เป้าหมาย",value:"< 60%",description:"มาตรฐานอุตสาหกรรมอาหาร"},{name:"Food Cost เป้าหมาย",value:"< 35%",description:"เฉพาะต้นทุนวัตถุดิบ"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"การตั้งค่าระบบ"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการการตั้งค่าทั่วไปและความเป็นส่วนตัว"})]}),e.jsxs(O,{onClick:w,children:[e.jsx(cs,{className:"w-4 h-4 mr-2"}),"บันทึกการตั้งค่า"]})]}),e.jsxs(we,{defaultValue:"general",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(G,{value:"general",children:"ทั่วไป"}),e.jsx(G,{value:"finance",children:"การเงิน"}),e.jsx(G,{value:"privacy",children:"ความเป็นส่วนตัว"}),e.jsx(G,{value:"defaults",children:"ค่าเริ่มต้น"}),e.jsx(G,{value:"help",children:"ความช่วยเหลือ"})]}),e.jsxs(H,{value:"general",className:"space-y-4",children:[e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(mr,{className:"w-5 h-5"}),"การตั้งค่าทั่วไป"]}),e.jsx(I,{children:"ภาษา สกุลเงิน และรูปแบบการแสดงผล"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"language",children:"ภาษา"}),e.jsxs(Ge,{value:l,onValueChange:o,children:[e.jsx(We,{children:e.jsx(He,{})}),e.jsxs(qe,{children:[e.jsx(re,{value:"th",children:"ไทย"}),e.jsx(re,{value:"en",children:"English"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"currency",children:"สกุลเงิน"}),e.jsxs(Ge,{value:d,onValueChange:m,children:[e.jsx(We,{children:e.jsx(He,{})}),e.jsxs(qe,{children:[e.jsx(re,{value:"THB",children:"บาทไทย (THB)"}),e.jsx(re,{value:"USD",children:"ดอลลาร์สหรัฐ (USD)"}),e.jsx(re,{value:"EUR",children:"ยูโร (EUR)"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"vat",children:"อัตราภาษีมูลค่าเพิ่ม (%)"}),e.jsx(B,{id:"vat",type:"number",step:"0.1",value:b,onChange:u=>p(parseFloat(u.target.value)||0),placeholder:"7"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"อัตรา VAT มาตรฐานในประเทศไทย: 7%"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"decimal",children:"ทศนิยม"}),e.jsxs(Ge,{defaultValue:"2",children:[e.jsx(We,{children:e.jsx(He,{})}),e.jsxs(qe,{children:[e.jsx(re,{value:"0",children:"ไม่มีทศนิยม"}),e.jsx(re,{value:"2",children:"2 ตำแหน่ง"}),e.jsx(re,{value:"4",children:"4 ตำแหน่ง"})]})]})]})]})]})]}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"วันและเวลาดำเนินการ"}),e.jsx(I,{children:"กำหนดวันเปิด-ปิดและชั่วโมงทำการ"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"open-time",children:"เวลาเปิด"}),e.jsx(B,{id:"open-time",type:"time",defaultValue:"07:00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"close-time",children:"เวลาปิด"}),e.jsx(B,{id:"close-time",type:"time",defaultValue:"15:00"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"วันเปิดทำการ"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์","อาทิตย์"].map((u,c)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{id:`day-${c}`,defaultChecked:c<6}),e.jsx(R,{htmlFor:`day-${c}`,className:"text-sm",children:u})]},u))})]})]})]})]}),e.jsx(H,{value:"finance",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"การตั้งค่าทางการเงิน"]}),e.jsx(I,{children:"กำหนดค่าเริ่มต้นสำหรับการคำนวณทางการเงิน"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"target-profit",children:"เป้าหมายกำไร/เดือน (บาท)"}),e.jsx(B,{id:"target-profit",type:"number",placeholder:"50000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"safety-margin",children:"Safety Margin ขั้นต่ำ (%)"}),e.jsx(B,{id:"safety-margin",type:"number",placeholder:"30"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"max-prime-cost",children:"Prime Cost สูงสุด (%)"}),e.jsx(B,{id:"max-prime-cost",type:"number",defaultValue:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"max-food-cost",children:"Food Cost สูงสุด (%)"}),e.jsx(B,{id:"max-food-cost",type:"number",defaultValue:"35"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{htmlFor:"include-vat",children:"รวม VAT ในราคาขาย"}),e.jsx(Ie,{id:"include-vat",defaultChecked:!0})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"เปิดใช้งานหากราคาเมนูในระบบรวม VAT แล้ว"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{htmlFor:"auto-calculate",children:"คำนวณอัตโนมัติ"}),e.jsx(Ie,{id:"auto-calculate",defaultChecked:!0})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"คำนวณใหม่ทุกครั้งที่มีการเปลี่ยนแปลงข้อมูล"})]})]})]})}),e.jsx(H,{value:"privacy",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(xr,{className:"w-5 h-5"}),"ความเป็นส่วนตัวและข้อมูล"]}),e.jsx(I,{children:"จัดการข้อมูลส่วนตัวและการรักษาความปลอดภัย"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"ข้อมูลของคุณปลอดภัย"}),e.jsx("p",{className:"text-sm text-blue-700",children:"ข้อมูลทั้งหมดถูกเก็บไว้ในเครื่องของคุณเท่านั้น ไม่มีการส่งข้อมูลไปยังเซิร์ฟเวอร์ภายนอก"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"ยอมรับนโยบายความเป็นส่วนตัว"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ข้อมูลจะถูกเก็บในหน่วยความจำของเบราว์เซอร์เท่านั้น"})]}),e.jsx(Ie,{checked:C,onCheckedChange:f})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"เปิดใช้งานการสำรองข้อมูลอัตโนมัติ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"สำรองข้อมูลลงใน localStorage ทุก 5 นาที"})]}),e.jsx(Ie,{defaultChecked:!0})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"จัดการข้อมูล"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{variant:"outline",className:"w-full justify-start",onClick:E,children:[e.jsx(cs,{className:"w-4 h-4 mr-2"}),"ส่งออกข้อมูลทั้งหมด"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:".json",onChange:S,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs(O,{variant:"outline",className:"w-full justify-start",children:[e.jsx(cs,{className:"w-4 h-4 mr-2"}),"นำเข้าข้อมูล"]})]}),e.jsxs(mt,{children:[e.jsx(xt,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-start text-orange-600 hover:text-orange-700",children:[e.jsx(ur,{className:"w-4 h-4 mr-2"}),"รีเซ็ตการตั้งค่า"]})}),e.jsxs(ut,{children:[e.jsxs(pt,{children:[e.jsx(ft,{children:"รีเซ็ตการตั้งค่า"}),e.jsx(jt,{children:"การดำเนินการนี้จะรีเซ็ตการตั้งค่าทั้งหมดกลับเป็นค่าเริ่มต้น แต่จะไม่ลบข้อมูลเมนู ต้นทุน และสถานการณ์"})]}),e.jsxs(gt,{children:[e.jsx(yt,{children:"ยกเลิก"}),e.jsx(vt,{onClick:T,children:"รีเซ็ต"})]})]})]}),e.jsxs(mt,{children:[e.jsx(xt,{asChild:!0,children:e.jsxs(O,{variant:"destructive",className:"w-full justify-start",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"ลบข้อมูลทั้งหมด"]})}),e.jsxs(ut,{children:[e.jsxs(pt,{children:[e.jsx(ft,{children:"ลบข้อมูลทั้งหมด"}),e.jsx(jt,{children:"การดำเนินการนี้จะลบข้อมูลทั้งหมดอย่างถาวร รวมถึงเมนู ต้นทุน สถานการณ์ และการตั้งค่า ไม่สามารถกู้คืนได้"})]}),e.jsxs(gt,{children:[e.jsx(yt,{children:"ยกเลิก"}),e.jsx(vt,{onClick:k,className:"bg-red-600 hover:bg-red-700",children:"ลบทั้งหมด"})]})]})]})]})]})]})]})}),e.jsx(H,{value:"defaults",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"ค่าเริ่มต้นที่แนะนำ"}),e.jsx(I,{children:"ค่าต่าง ๆ ที่แนะนำสำหรับร้านอาหารขนาดเล็ก (ข้อมูลอ้างอิงเท่านั้น)"})]}),e.jsxs($,{children:[e.jsx("div",{className:"space-y-4",children:j.map((u,c)=>e.jsxs("div",{className:"flex justify-between items-start p-3 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:u.description})]}),e.jsx(q,{variant:"outline",children:u.value})]},c))}),e.jsxs("div",{className:"mt-6 p-4 bg-orange-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-orange-900 mb-2",children:"หมายเหตุ"}),e.jsx("p",{className:"text-sm text-orange-700",children:"ค่าดังกล่าวเป็นเพียงข้อมูลอ้างอิงเท่านั้น กรุณาปรับให้เหมาะสมกับสถานการณ์จริงของธุรกิจ"})]})]})]})}),e.jsx(H,{value:"help",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(pr,{className:"w-5 h-5"}),"ความช่วยเหลือ"]}),e.jsx(I,{children:"คำแนะนำการใช้งานและคำศัพท์ทางการเงิน"})]}),e.jsx($,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"คำศัพท์สำคัญ"}),e.jsx("div",{className:"space-y-2 text-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-muted rounded",children:[e.jsx("div",{className:"font-medium",children:"Prime Cost"}),e.jsx("div",{className:"text-muted-foreground",children:"ต้นทุนวัตถุดิบ + แรงงานโดยตรง"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded",children:[e.jsx("div",{className:"font-medium",children:"Contribution Margin (CM)"}),e.jsx("div",{className:"text-muted-foreground",children:"ราคาขาย - ต้นทุนผันแปร"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded",children:[e.jsx("div",{className:"font-medium",children:"Break-Even Point (BEP)"}),e.jsx("div",{className:"text-muted-foreground",children:"จุดคุ้มทุน (ไม่กำไรไม่ขาดทุน)"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded",children:[e.jsx("div",{className:"font-medium",children:"Safety Margin"}),e.jsx("div",{className:"text-muted-foreground",children:"ระยะห่างจากจุดคุ้มทุน"})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"เป้าหมายที่แนะนำ"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{children:"• Prime Cost: ไม่เกิน 60% ของรายได้"}),e.jsx("div",{children:"• Food Cost: ไม่เกิน 35% ของรายได้"}),e.jsx("div",{children:"• Labor Cost: ไม่เกิน 25% ของรายได้"}),e.jsx("div",{children:"• Contribution Margin: มากกว่า 60%"}),e.jsx("div",{children:"• Safety Margin: มากกว่า 30%"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"การแก้ไขปัญหา"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{children:"• หาก Prime Cost สูง: ลดต้นทุนวัตถุดิบหรือเพิ่มราคาขาย"}),e.jsx("div",{children:"• หาก Safety Margin ต่ำ: เพิ่มยอดขายหรือลดต้นทุนคงที่"}),e.jsx("div",{children:"• หาก CM % ต่ำ: ทบทวนสูตรอาหารหรือขึ้นราคา"})]})]})]})})]})})]})]})}const di=Vs("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Os({className:a,variant:s,...t}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:U(di({variant:s}),a),...t})}function _s({className:a,...s}){return e.jsx("div",{"data-slot":"alert-description",className:U("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...s})}class hi extends v.Component{constructor(s){super(s),this.state={hasError:!1,error:null,errorInfo:null,errorId:""}}static getDerivedStateFromError(s){return{hasError:!0,error:s,errorId:`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}componentDidCatch(s,t){console.error("ErrorBoundary caught an error:",s,t),this.setState({error:s,errorInfo:t}),this.props.onError&&this.props.onError(s,t),this.logErrorToService(s,t)}logErrorToService(s,t){try{const r={errorId:this.state.errorId,message:s.message,stack:s.stack,componentStack:t.componentStack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href};console.error("Error Report:",r)}catch(r){console.error("Failed to log error:",r)}}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:""})};handleReload=()=>{window.location.reload()};handleGoHome=()=>{window.location.href="/"};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs(P,{className:"w-full max-w-2xl",children:[e.jsxs(z,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-red-100",children:e.jsx(be,{className:"h-6 w-6 text-red-600"})}),e.jsx(L,{className:"text-2xl font-bold text-gray-900",children:"เกิดข้อผิดพลาด"}),e.jsx(I,{className:"text-gray-600",children:"ระบบพบข้อผิดพลาดที่ไม่คาดคิด กรุณาลองใหม่อีกครั้ง"})]}),e.jsxs($,{className:"space-y-6",children:[e.jsxs(Os,{variant:"destructive",children:[e.jsx(be,{className:"h-4 w-4"}),e.jsx(_s,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:"รายละเอียดข้อผิดพลาด:"}),e.jsx("p",{className:"text-sm",children:this.state.error?.message||"Unknown error"}),!1]})})]}),e.jsxs("div",{className:"text-center text-sm text-gray-500",children:[e.jsxs("p",{children:["Error ID: ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:this.state.errorId})]}),e.jsx("p",{className:"mt-1",children:"กรุณาบันทึก Error ID นี้ไว้สำหรับการติดต่อฝ่ายสนับสนุน"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(O,{onClick:this.handleRetry,className:"flex items-center gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),"ลองใหม่"]}),e.jsxs(O,{variant:"outline",onClick:this.handleReload,className:"flex items-center gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),"โหลดหน้าใหม่"]}),e.jsxs(O,{variant:"outline",onClick:this.handleGoHome,className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"กลับหน้าหลัก"]})]}),e.jsxs("div",{className:"text-center text-sm text-gray-600",children:[e.jsx("p",{children:"หากปัญหายังคงเกิดขึ้น กรุณา:"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-left max-w-md mx-auto",children:[e.jsx("li",{children:"• ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต"}),e.jsx("li",{children:"• ล้างข้อมูลเบราว์เซอร์ (Cache & Cookies)"}),e.jsx("li",{children:"• ลองใช้เบราว์เซอร์อื่น"}),e.jsx("li",{children:"• ติดต่อฝ่ายสนับสนุนพร้อม Error ID"})]})]})]})]})}):this.props.children}}const mi={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8",xl:"h-12 w-12"},ka=({size:a="md",className:s,text:t,fullScreen:r=!1})=>{const n=e.jsx("div",{className:As("flex items-center justify-center",s),children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(gr,{className:As("animate-spin text-blue-600",mi[a])}),t&&e.jsx("p",{className:"text-sm text-gray-600 animate-pulse",children:t})]})});return r?e.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:n}):n},xi=({isLoading:a,children:s,text:t="กำลังโหลด...",className:r})=>e.jsxs("div",{className:As("relative",r),children:[s,a&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10",children:e.jsx(ka,{text:t,size:"lg"})})]}),bt=({validationResults:a,onDismiss:s,className:t,showWarnings:r=!0,compact:n=!1})=>{if(!a||a.length===0)return null;const i=a.some(m=>!m.isValid),l=a.some(m=>m.warnings.length>0),o=a.flatMap(m=>m.errors),d=a.flatMap(m=>m.warnings);return!i&&(!r||!l)?null:n?e.jsxs("div",{className:t,children:[i&&e.jsxs(Os,{variant:"destructive",className:"mb-2",children:[e.jsx(be,{className:"h-4 w-4"}),e.jsx(_s,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["พบข้อผิดพลาด ",o.length," ข้อ",l&&r&&` และคำเตือน ${d.length} ข้อ`]}),s&&e.jsx(O,{variant:"ghost",size:"sm",onClick:s,className:"h-auto p-1",children:e.jsx(Be,{className:"h-4 w-4"})})]})})]}),!i&&l&&r&&e.jsxs(Os,{className:"mb-2",children:[e.jsx(st,{className:"h-4 w-4"}),e.jsx(_s,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["พบคำเตือน ",d.length," ข้อ"]}),s&&e.jsx(O,{variant:"ghost",size:"sm",onClick:s,className:"h-auto p-1",children:e.jsx(Be,{className:"h-4 w-4"})})]})})]})]}):e.jsxs("div",{className:t,children:[i&&e.jsxs(P,{className:"mb-4 border-red-200 bg-red-50",children:[e.jsxs(z,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(be,{className:"h-5 w-5 text-red-600"}),e.jsx(L,{className:"text-red-800",children:"ข้อผิดพลาดที่ต้องแก้ไข"})]}),s&&e.jsx(O,{variant:"ghost",size:"sm",onClick:s,className:"h-auto p-1 text-red-600 hover:text-red-800",children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsxs(I,{className:"text-red-700",children:["พบข้อผิดพลาด ",o.length," ข้อที่ต้องแก้ไขก่อนดำเนินการต่อ"]})]}),e.jsx($,{children:e.jsx("ul",{className:"space-y-2",children:o.map((m,b)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-red-700",children:[e.jsx("span",{className:"text-red-500 mt-0.5",children:"•"}),e.jsx("span",{children:m})]},b))})})]}),l&&r&&e.jsxs(P,{className:"mb-4 border-yellow-200 bg-yellow-50",children:[e.jsxs(z,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(st,{className:"h-5 w-5 text-yellow-600"}),e.jsx(L,{className:"text-yellow-800",children:"คำเตือน"})]}),s&&e.jsx(O,{variant:"ghost",size:"sm",onClick:s,className:"h-auto p-1 text-yellow-600 hover:text-yellow-800",children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsxs(I,{className:"text-yellow-700",children:["พบคำเตือน ",d.length," ข้อ กรุณาตรวจสอบข้อมูล"]})]}),e.jsx($,{children:e.jsx("ul",{className:"space-y-2",children:d.map((m,b)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-yellow-700",children:[e.jsx("span",{className:"text-yellow-500 mt-0.5",children:"•"}),e.jsx("span",{children:m})]},b))})})]})]})};function ui({scenarios:a,currentScenario:s,onScenarioChange:t,onCompare:r}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"สถานการณ์:"}),e.jsx("select",{value:s,onChange:n=>t(n.target.value),className:"bg-background border border-border rounded px-2 py-1 text-sm",children:a.map(n=>e.jsx("option",{value:n,children:n==="base"?"ฐาน (Base)":n},n))})]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:r,children:[e.jsx(Je,{className:"w-4 h-4 mr-1"}),"เปรียบเทียบ"]})]})}function pi(){const[a,s]=v.useState("dashboard"),{data:t,computationResult:r,validationResults:n,isLoading:i,error:l,scenarios:o,currentScenario:d,setCurrentScenario:m,clearError:b}=de(),{hasErrors:p,hasWarnings:C}=Cn();return i&&!t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx(ka,{size:"xl",text:"กำลังเริ่มต้นระบบจำลองการเงิน..."})})}):e.jsx(hi,{children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b bg-card",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"ระบบจำลองการเงิน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ร้านเสน่ห์ข้าวมันไก่"})]})]}),e.jsx(ui,{scenarios:Object.keys(o),currentScenario:d,onScenarioChange:m,onCompare:()=>s("scenarios")})]})})}),l&&e.jsx("div",{className:"container mx-auto px-4 py-2",children:e.jsx(bt,{validationResults:[{isValid:!1,errors:[l],warnings:[]}],onDismiss:b,compact:!0})}),(p||C)&&e.jsx("div",{className:"container mx-auto px-4 py-2",children:e.jsx(bt,{validationResults:n,onDismiss:b})}),e.jsx(xi,{isLoading:i,text:"กำลังคำนวณ...",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs(we,{value:a,onValueChange:s,className:"space-y-6",children:[e.jsxs(Pe,{className:"grid w-full grid-cols-9 gap-1",children:[e.jsxs(G,{value:"dashboard",className:"flex flex-col gap-1 p-3",children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"แดชบอร์ด"})]}),e.jsxs(G,{value:"sales",className:"flex flex-col gap-1 p-3",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"ยอดขาย"})]}),e.jsxs(G,{value:"menu",className:"flex flex-col gap-1 p-3",children:[e.jsx(fr,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"เมนู & สูตร"})]}),e.jsxs(G,{value:"utilities",className:"flex flex-col gap-1 p-3",children:[e.jsx(is,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"สาธารณูปโภค"})]}),e.jsxs(G,{value:"labor",className:"flex flex-col gap-1 p-3",children:[e.jsx(ls,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"แรงงาน"})]}),e.jsxs(G,{value:"fixed",className:"flex flex-col gap-1 p-3",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"ค่าใช้จ่ายคงที่"})]}),e.jsxs(G,{value:"scenarios",className:"flex flex-col gap-1 p-3",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"สถานการณ์"})]}),e.jsxs(G,{value:"reports",className:"flex flex-col gap-1 p-3",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"รายงาน"})]}),e.jsxs(G,{value:"settings",className:"flex flex-col gap-1 p-3",children:[e.jsx(cs,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"ตั้งค่า"})]})]}),e.jsx(H,{value:"dashboard",className:"space-y-6",children:e.jsx(sn,{currentScenario:d,financialData:r})}),e.jsx(H,{value:"sales",className:"space-y-6",children:e.jsx(Sn,{})}),e.jsx(H,{value:"menu",className:"space-y-6",children:e.jsx(Mn,{})}),e.jsx(H,{value:"utilities",className:"space-y-6",children:e.jsx(Rn,{})}),e.jsx(H,{value:"labor",className:"space-y-6",children:e.jsx(Tn,{})}),e.jsx(H,{value:"fixed",className:"space-y-6",children:e.jsx(On,{})}),e.jsx(H,{value:"scenarios",className:"space-y-6",children:e.jsx(_n,{currentScenario:d,onScenarioChange:m})}),e.jsx(H,{value:"reports",className:"space-y-6",children:e.jsx(Fn,{financialData:r})}),e.jsx(H,{value:"settings",className:"space-y-6",children:e.jsx(oi,{})})]})})})]})})}const Da=document.getElementById("root");if(!Da)throw new Error("Root element not found");vr.createRoot(Da).render(e.jsx(pi,{}));
